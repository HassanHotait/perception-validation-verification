<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>metrics_functions_from_evaluation_script &mdash; Internship Professional Products Documentation 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Internship Professional Products Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Internship Professional Products Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">metrics_functions_from_evaluation_script</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for metrics_functions_from_evaluation_script</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">table</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="c1">#from torch import mode</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">evaluation_toolbox</span> <span class="kn">import</span> <span class="n">rectanges_overlap</span><span class="p">,</span><span class="n">Point</span><span class="p">,</span><span class="n">get_IoU</span><span class="p">,</span><span class="n">get_key</span><span class="p">,</span><span class="n">yolo_get_key</span>
<span class="kn">import</span> <span class="nn">dataframe_image</span> <span class="k">as</span> <span class="nn">dfi</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.utility</span> <span class="kn">import</span> <span class="n">xl_rowcol_to_cell</span>
<span class="kn">import</span>  <span class="nn">xlsxwriter</span>
<span class="n">field_name_cars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Easy Car TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Car Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Car Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Car Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Car Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Filtered Gt Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Easy Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Moderate Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Hard Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Ignored Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Filtered Pred Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Easy Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Moderate Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Hard Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Ignored Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;Σ filtered Gt Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Easy Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Moderate Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Hard Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Easy Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Moderate Cars&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Hard Cars&#39;</span><span class="p">,]</span>


<span class="n">field_name_cyclists</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Easy Cyclist TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Cyclist Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Cyclist Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Cyclist Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Cyclist Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Filtered Gt Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Easy Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Moderate Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Hard Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Ignored Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Filtered Pred Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Easy Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Moderate Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Hard Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Ignored Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;Σ filtered Gt Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Easy Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Moderate Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Hard Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Easy Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Moderate Cyclists&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Hard Cyclists&#39;</span><span class="p">,]</span>

<span class="n">field_name_pedestrians</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Easy Pedestrian TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Easy Pedestrian Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moderate Pedestrian Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Hard Pedestrian Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian TP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian FP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian FN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian Frame Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian Frame Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian ΣTP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian ΣFP&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian ΣFN&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian ΣPrecision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian ΣRecall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian Mean Precision&#39;</span><span class="p">,</span>
<span class="s1">&#39;Overall Pedestrian Mean Recall&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Filtered Gt Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Easy Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Moderate Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Hard Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gt Ignored Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Filtered Pred Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Easy Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Moderate Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Hard Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pred Ignored Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;Σ filtered Gt Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Easy Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Moderate Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣGt Hard Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Easy Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Moderate Pedestrians&#39;</span><span class="p">,</span>
<span class="s1">&#39;ΣPred Hard Pedestrians&#39;</span><span class="p">,]</span>

<div class="viewcode-block" id="GtInfo"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.GtInfo">[docs]</a><span class="k">class</span> <span class="nc">GtInfo</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">truncation</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occlusion</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># local orientation = alpha + pi/2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="c1"># in pixel coordinate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>

        <span class="c1"># height, weigh, length in object coordinate, meter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>

        <span class="c1"># x, y, z in camera coordinate, meter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span>

        <span class="c1"># global orientation [-pi, pi]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rot_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels_list</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncation</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">occlusion</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rot_global</span><span class="p">]</span>

<div class="viewcode-block" id="GtInfo.get_labels_list"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.GtInfo.get_labels_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_labels_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels_list</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncation</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">occlusion</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rot_global</span><span class="p">]</span></div></div>
<div class="viewcode-block" id="read_groundtruth"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.read_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">read_groundtruth</span><span class="p">(</span><span class="n">gt_folder</span><span class="p">,</span><span class="n">fileid</span><span class="p">,</span><span class="n">extension</span><span class="p">):</span>
    <span class="n">boxs_groundtruth_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gt_folder</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">extension</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">boxs_groundtruth_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">boxs_groundtruth_string</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">boxs_groundtruth_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">firstLine_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>


    <span class="n">groundtruth_list</span><span class="o">=</span><span class="n">boxs_groundtruth_string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="c1">#groundtruth_list=[boxs_groundtruth_string[i].split(&#39;,&#39;) for i in range(len(boxs_groundtruth_string))]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Groundtruth[0]: &quot;</span><span class="p">,</span><span class="n">groundtruth_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">groundtruth</span> <span class="o">=</span> <span class="p">[</span><span class="n">groundtruth_list</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="n">firstLine_elements</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groundtruth_list</span><span class="p">)),</span><span class="n">firstLine_elements</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">groundtruth</span></div>

<div class="viewcode-block" id="new_read_groundtruth"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.new_read_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">new_read_groundtruth</span><span class="p">(</span><span class="n">gt_folder</span><span class="p">,</span><span class="n">fileid</span><span class="p">,</span><span class="n">extension</span><span class="p">,</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">boxs_groundtruth_filepath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gt_folder</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">extension</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">boxs_groundtruth_filepath</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">boxs_groundtruth_string</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;list of groundtruth: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">boxs_groundtruth_string</span><span class="p">)</span>
    

    <span class="c1"># if dataset==&quot;Kitti&quot;:</span>
    <span class="c1">#     groundtruth=[GtInfo(gt[0].split(&#39; &#39;)) for gt in boxs_groundtruth_string]</span>
    <span class="c1"># elif dataset==&quot;Prescan&quot;:</span>
    <span class="c1">#     groundtruth=[GtInfo(gt) for gt in boxs_groundtruth_string]</span>

    <span class="n">groundtruth</span><span class="o">=</span><span class="p">[</span><span class="n">GtInfo</span><span class="p">(</span><span class="n">gt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">boxs_groundtruth_string</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># with open(boxs_groundtruth_file,&#39;r&#39;) as file:</span>
    <span class="c1">#     firstLine_elements = len(file.readline().split())</span>


    <span class="c1"># groundtruth_list=boxs_groundtruth_string.split()</span>
    <span class="c1"># #groundtruth_list=[boxs_groundtruth_string[i].split(&#39;,&#39;) for i in range(len(boxs_groundtruth_string))]</span>
    <span class="c1"># print(&quot;Groundtruth[0]: &quot;,groundtruth_list[0])</span>
    <span class="c1"># groundtruth = [groundtruth_list[x:x+firstLine_elements] for x in range(0,int(len(groundtruth_list)),firstLine_elements)]</span>

    <span class="k">return</span> <span class="n">groundtruth</span></div>

<div class="viewcode-block" id="box_does_not_intersect_with_all_boxes_in_list"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.box_does_not_intersect_with_all_boxes_in_list">[docs]</a><span class="k">def</span> <span class="nf">box_does_not_intersect_with_all_boxes_in_list</span><span class="p">(</span><span class="n">random_box</span><span class="p">,</span><span class="n">boxes_in_list</span><span class="p">):</span>
    <span class="n">flag</span><span class="o">=</span><span class="kc">False</span>

    <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">boxes_in_list</span><span class="p">:</span>
        <span class="c1">#print((random_box[0],random_box[1],box[0],box[1]))</span>
        <span class="n">inter_flag</span><span class="p">,</span><span class="n">overlap_condition</span><span class="o">=</span><span class="n">rectanges_overlap</span><span class="p">(</span><span class="n">random_box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">random_box</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inter_flag</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
            <span class="n">flag</span><span class="o">=</span><span class="kc">True</span>

            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span><span class="n">overlap_condition</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag</span><span class="o">=</span><span class="kc">False</span>

    <span class="k">return</span> <span class="n">flag</span><span class="p">,</span><span class="n">overlap_condition</span></div>



<div class="viewcode-block" id="get_plot_groundtruth"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_plot_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">get_plot_groundtruth</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">):</span> 
    <span class="n">n_truth</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">)</span>
    <span class="n">height</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">width</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;h: &#39;</span><span class="p">,</span><span class="n">height</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;w: &#39;</span><span class="p">,</span><span class="n">width</span><span class="p">)</span>

    <span class="n">start_point</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    
                            <span class="c1"># easy,moderate,hard</span>
    <span class="n">possible_box_dimensions</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>

    
    <span class="n">img_with_groundtruth</span><span class="o">=</span><span class="n">img</span>

    <span class="n">boxs</span><span class="o">=</span><span class="p">[]</span>

    <span class="c1"># font</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span>

    <span class="c1"># org</span>
    <span class="c1">#org = (int(pt1.x+(box_width/2)),int(pt1.y+(box_height/2)))</span>

    <span class="c1"># fontScale</span>
    <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># Blue color in BGR</span>
    <span class="n">green_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Line thickness of 2 px</span>
    <span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">gt_class_dim_list</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_truth</span><span class="p">):</span>
        <span class="c1"># Shift</span>
        <span class="c1">#flag_intersection=False</span>
        <span class="n">random_box_dimensions_selector</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">box_width</span><span class="o">=</span><span class="n">possible_box_dimensions</span><span class="p">[</span><span class="n">random_box_dimensions_selector</span><span class="p">]</span>
        <span class="n">box_height</span><span class="o">=</span><span class="n">box_width</span>
        <span class="n">gt_class_dim_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">box_width</span><span class="p">,</span><span class="n">box_height</span><span class="p">))</span>
        <span class="n">x</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_width</span><span class="p">,</span><span class="n">width</span><span class="o">-</span><span class="n">box_width</span><span class="p">)</span>
        <span class="n">y</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_height</span><span class="p">,</span><span class="n">height</span><span class="o">-</span><span class="n">box_height</span><span class="p">)</span>
        <span class="n">pt1</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="n">pt2</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">box_width</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">box_height</span><span class="p">)</span>
        <span class="n">random_box</span><span class="o">=</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span><span class="n">pt2</span><span class="p">)</span>
        <span class="c1"># print(&#39;x: &#39;,x)</span>
        <span class="c1"># print(&#39;y :&#39;,y)</span>

        <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">flag_intersection</span><span class="p">,</span><span class="n">overlap_condition</span><span class="o">=</span><span class="n">box_does_not_intersect_with_all_boxes_in_list</span><span class="p">(</span><span class="n">random_box</span><span class="p">,</span><span class="n">boxs</span><span class="p">)</span>


            <span class="c1"># for i in range(len(boxs)):</span>
            <span class="c1">#     box_in_list_pt1=Point(boxs[i][0],boxs[i][1])</span>
            <span class="c1">#     box_in_list_pt2=Point(boxs[i][2],boxs[i][3])</span>

            <span class="k">while</span> <span class="n">flag_intersection</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                <span class="c1">#print(&#39;While Loop Counter: &#39;,while_loop_counter)</span>
                <span class="n">x</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_width</span><span class="p">,</span><span class="n">width</span><span class="o">-</span><span class="n">box_width</span><span class="p">)</span>
                <span class="n">y</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_height</span><span class="p">,</span><span class="n">height</span><span class="o">-</span><span class="n">box_height</span><span class="p">)</span>
                <span class="n">pt1</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="n">pt2</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">box_width</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">box_height</span><span class="p">)</span>
                <span class="n">random_box</span><span class="o">=</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span><span class="n">pt2</span><span class="p">)</span>
                <span class="n">flag_intersection</span><span class="p">,</span><span class="n">overlap_condition</span><span class="o">=</span><span class="n">box_does_not_intersect_with_all_boxes_in_list</span><span class="p">(</span><span class="n">random_box</span><span class="p">,</span><span class="n">boxs</span><span class="p">)</span>
                <span class="c1">#while_loop_counter+=1</span>

                <span class="c1">#print(&#39;plotting_point:&#39;,while_loop_counter)</span>
            <span class="c1">#print(&#39;rect: &#39;,((pt1.x,pt1.y),(pt2.x,pt2.y)))</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overlap Condition: &#39;</span><span class="p">,</span><span class="n">overlap_condition</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rectangle: &#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Just plotted a rectangle flag intersection was: &#39;</span><span class="p">,</span><span class="n">flag_intersection</span><span class="p">)</span>
            <span class="n">img_with_groundtruth</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">img_with_groundtruth</span><span class="p">,(</span><span class="n">pt1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pt1</span><span class="o">.</span><span class="n">y</span><span class="p">),(</span><span class="n">pt2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pt2</span><span class="o">.</span><span class="n">y</span><span class="p">),</span><span class="n">green_color</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1"># font</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span>
  
            <span class="c1"># org</span>
            <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pt1</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="p">(</span><span class="n">box_width</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="n">pt1</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">box_height</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>

   
            <span class="c1"># Using cv2.putText() method</span>
            <span class="c1">#img_with_groundtruth = cv2.putText(img_with_groundtruth, str(i), org, font, fontScale, color, thickness, cv2.LINE_AA)</span>
            <span class="n">img_with_groundtruth</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">img_with_groundtruth</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">org</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fontScale</span><span class="p">,</span> <span class="n">green_color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
            <span class="n">boxs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">box_width</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">box_height</span><span class="p">)))</span>

                

            <span class="c1">#boxs.append((x,y,x+box_width,y+box_height))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag_intersection</span><span class="o">=</span><span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rectangle: &#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Just plotted a rectangle flag intersection was: &#39;</span><span class="p">,</span><span class="n">flag_intersection</span><span class="p">)</span>
            <span class="n">img_with_groundtruth</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">img_with_groundtruth</span><span class="p">,(</span><span class="n">pt1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pt1</span><span class="o">.</span><span class="n">y</span><span class="p">),(</span><span class="n">pt2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pt2</span><span class="o">.</span><span class="n">y</span><span class="p">),</span><span class="n">green_color</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># org</span>
            <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pt1</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="p">(</span><span class="n">box_width</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="n">pt1</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">box_height</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
   
            <span class="c1"># Using cv2.putText() method</span>
            <span class="n">img_with_groundtruth</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">img_with_groundtruth</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">org</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fontScale</span><span class="p">,</span> <span class="n">green_color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
            <span class="n">boxs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">box_width</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">box_height</span><span class="p">)))</span>
            <span class="c1">#print(&#39;boxs: &#39;,boxs)</span>

        
    <span class="k">return</span> <span class="n">boxs</span><span class="p">,</span><span class="n">img_with_groundtruth</span><span class="p">,</span><span class="n">gt_class_dim_list</span></div>

<div class="viewcode-block" id="get_plot_predictions"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_plot_predictions">[docs]</a><span class="k">def</span> <span class="nf">get_plot_predictions</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">box_dimensions</span><span class="p">,</span><span class="n">img_dimensions</span><span class="p">,</span><span class="n">gt_img</span><span class="p">,</span><span class="n">predicted_classes</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="n">total_predictions_n</span><span class="p">):</span>

    <span class="n">img_width</span><span class="o">=</span><span class="n">img_dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">img_height</span><span class="o">=</span><span class="n">img_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pred_boxs</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">output_img</span><span class="o">=</span><span class="n">gt_img</span>

    <span class="c1"># font</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span>

    <span class="c1"># org</span>
    <span class="c1">#org = (int(pt1.x+(box_width/2)),int(pt1.y+(box_height/2)))</span>

    <span class="c1"># fontScale</span>
    <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># Blue color in BGR</span>
    <span class="n">red_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>

    <span class="c1"># Line thickness of 2 px</span>
    <span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">gt_box</span> <span class="ow">in</span> <span class="n">gt_boxs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">total_predictions_n</span><span class="p">]:</span>
        <span class="n">box_width</span><span class="o">=</span><span class="n">box_dimensions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="c1">#box_dimensions[0]</span>
        <span class="n">box_height</span><span class="o">=</span><span class="n">box_dimensions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="c1">#x_dimensions[1]</span>
        <span class="n">x_shift</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">box_width</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">box_width</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">y_shift</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">box_height</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">box_height</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">pred_pt1</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">gt_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="n">x_shift</span><span class="p">,</span><span class="n">gt_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="n">y_shift</span><span class="p">)</span>
        <span class="n">pred_pt2</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="n">box_width</span><span class="p">,</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="n">box_height</span><span class="p">)</span>

        <span class="n">pred_boxs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pred_pt1</span><span class="p">,</span><span class="n">pred_pt2</span><span class="p">))</span>

        <span class="n">output_img</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">output_img</span><span class="p">,(</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">y</span><span class="p">),(</span><span class="n">pred_pt2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pred_pt2</span><span class="o">.</span><span class="n">y</span><span class="p">),</span><span class="n">red_color</span><span class="p">,</span><span class="n">thickness</span><span class="p">)</span>
        <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="p">(</span><span class="n">box_width</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">box_height</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">output_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">output_img</span><span class="p">,</span> <span class="n">predicted_classes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">org</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fontScale</span><span class="p">,</span> <span class="n">red_color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">):</span>
        <span class="n">false_positive_index_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False positive index range: &#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">false_positive_index_range</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">false_positive_index_range</span><span class="p">):</span>
            <span class="n">x</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_width</span><span class="p">,</span><span class="n">img_width</span><span class="o">-</span><span class="n">box_width</span><span class="p">)</span>
            <span class="n">y</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_height</span><span class="p">,</span><span class="n">img_height</span><span class="o">-</span><span class="n">box_height</span><span class="p">)</span>
            <span class="n">pred_pt1</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
            <span class="n">pred_pt2</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">box_width</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">box_height</span><span class="p">)</span>
            <span class="n">random_box</span><span class="o">=</span><span class="p">(</span><span class="n">pred_pt1</span><span class="p">,</span><span class="n">pred_pt2</span><span class="p">)</span>

            <span class="n">flag_intersection</span><span class="p">,</span><span class="n">overlap_condition</span><span class="o">=</span><span class="n">box_does_not_intersect_with_all_boxes_in_list</span><span class="p">(</span><span class="n">random_box</span><span class="p">,</span><span class="n">gt_boxs</span><span class="o">+</span><span class="n">pred_boxs</span><span class="p">)</span>


            <span class="c1"># for i in range(len(boxs)):q</span>
            <span class="c1">#     box_in_list_pt1=Point(boxs[i][0],boxs[i][1])</span>
            <span class="c1">#     box_in_list_pt2=Point(boxs[i][2],boxs[i][3])</span>

            <span class="k">while</span> <span class="n">flag_intersection</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                <span class="c1">#print(&#39;While Loop Counter: &#39;,while_loop_counter)</span>
                <span class="n">x</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_width</span><span class="p">,</span><span class="n">img_width</span><span class="o">-</span><span class="n">box_width</span><span class="p">)</span>
                <span class="n">y</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">box_height</span><span class="p">,</span><span class="n">img_height</span><span class="o">-</span><span class="n">box_height</span><span class="p">)</span>
                <span class="n">pred_pt1</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="n">pred_pt2</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">box_width</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">box_height</span><span class="p">)</span>
                <span class="n">random_box</span><span class="o">=</span><span class="p">(</span><span class="n">pred_pt1</span><span class="p">,</span><span class="n">pred_pt2</span><span class="p">)</span>
                <span class="n">flag_intersection</span><span class="p">,</span><span class="n">overlap_condition</span><span class="o">=</span><span class="n">box_does_not_intersect_with_all_boxes_in_list</span><span class="p">(</span><span class="n">random_box</span><span class="p">,</span><span class="n">gt_boxs</span><span class="o">+</span><span class="n">pred_boxs</span><span class="p">)</span>


            <span class="n">output_img</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">output_img</span><span class="p">,(</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">y</span><span class="p">),(</span><span class="n">pred_pt2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pred_pt2</span><span class="o">.</span><span class="n">y</span><span class="p">),</span><span class="n">red_color</span><span class="p">,</span><span class="n">thickness</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i in FPs: &#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FP Predicted Class Index:&#39;</span><span class="p">,</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="p">(</span><span class="n">box_width</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_pt1</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">box_height</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">output_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">output_img</span><span class="p">,</span> <span class="n">predicted_classes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">org</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">fontScale</span><span class="p">,</span> <span class="n">red_color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
            
            <span class="n">false_positive_box</span><span class="o">=</span><span class="p">[</span><span class="n">random_box</span><span class="p">]</span>

            <span class="n">pred_boxs</span><span class="o">=</span><span class="n">pred_boxs</span><span class="o">+</span><span class="n">false_positive_box</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">pred_boxs</span><span class="p">,</span><span class="n">output_img</span></div>

<div class="viewcode-block" id="get_gt_classes"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_gt_classes">[docs]</a><span class="k">def</span> <span class="nf">get_gt_classes</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">n_gt_detections</span><span class="p">):</span>

    <span class="n">gt_classes</span><span class="o">=</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_gt_detections</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">gt_classes</span></div>

<div class="viewcode-block" id="get_predicted_classes"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_predicted_classes">[docs]</a><span class="k">def</span> <span class="nf">get_predicted_classes</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">total_predictions_n</span><span class="p">):</span>


    <span class="n">predicted_classes</span><span class="o">=</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_predictions_n</span><span class="p">)]</span>

    <span class="c1"># for i in range(false_positive_n):</span>
    <span class="c1">#     x_shift=random.randint(-box_width/4,box_width/4)</span>
    <span class="c1">#     y_shift=random.randint(-box_height/4,box_height/4)</span>
    <span class="c1">#     pred_pt1=Point(gt_box[0].x+x_shift,gt_box[0].y+y_shift)</span>
    <span class="c1">#     pred_pt2=Point(pred_pt1.x+box_width,pred_pt1.y+box_height)</span>
        
    <span class="c1">#     false_positive_box=[(pred_pt1,pred_pt2)]</span>

    <span class="c1">#     pred_boxs=pred_boxs+false_positive_box</span>

    <span class="k">return</span> <span class="n">predicted_classes</span></div>

<span class="c1"># def get_metrics(gt_classes,predicted_classes,labels):</span>
<span class="c1">#     gt_label_count=[]</span>
<span class="c1">#     pred_label_count=[]</span>
<span class="c1">#     for label in labels:</span>
<span class="c1">#         gt_label_count.append(gt_classes.count(label))</span>
<span class="c1">#         pred_label_count.append(predicted_classes.count(label))</span>

<span class="c1">#     if len(predicted_classes)&gt;len(gt_classes):</span>
<span class="c1">#         FP=len(predicted_classes)-len(gt_classes)</span>
<span class="c1">#     else:</span>
<span class="c1">#         FP=0</span>
    
<span class="c1">#     TP=0</span>

<span class="c1">#     if len(gt_classes)&gt;len(predicted_classes):</span>
<span class="c1">#         indix_range=len(predicted_classes)</span>

<span class="c1">#     else:</span>
<span class="c1">#         indix_range=len(gt_classes)</span>

<span class="c1">#     for i in range(indix_range):</span>
<span class="c1">#         if gt_classes[i]==predicted_classes[i]:</span>
<span class="c1">#             TP=TP+1</span>

<span class="c1">#         else:</span>
<span class="c1">#             FP=FP+1</span>


<span class="c1">#     gt_ROIs=len(gt_classes)</span>
<span class="c1">#     predicted_ROIs=len(pred_boxs)</span>
<span class="c1">#     FN=len(gt_boxs)-TP</span>

<span class="c1">#     return gt_ROIs,predicted_ROIs,TP,FP,FN</span>



<div class="viewcode-block" id="get_metrics_label_specific"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_metrics_label_specific">[docs]</a><span class="k">def</span> <span class="nf">get_metrics_label_specific</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="n">predicted_classes</span><span class="p">,</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">pred_boxs</span><span class="p">):</span>
    <span class="n">gt_label_count</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">pred_label_count</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">gt_label_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt_classes</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
        <span class="n">pred_label_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predicted_classes</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>

    <span class="n">i</span><span class="o">=</span><span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i: &#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># gt_instances_label=gt_label_count[i]</span>
    <span class="c1"># predicted_instances_label=pred_label_count[i]</span>

    <span class="c1">#print()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Label Count: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predictions Label Count: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class A Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred Class A Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class B Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred Class B Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class C Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred Class C Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    

    <span class="n">gt_index_list</span><span class="o">=</span><span class="n">get_box_difficulty_index</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">)</span>
    <span class="n">pred_index_list</span><span class="o">=</span><span class="n">get_box_difficulty_index</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">,</span><span class="n">predicted_classes</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicted Class Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicted Easy instances: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_index_list</span><span class="p">))</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Easy instances: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_index_list</span><span class="p">))</span>



    <span class="n">gt_classes_label</span><span class="o">=</span><span class="p">[</span><span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gt_index_list</span><span class="p">]</span> 

    <span class="n">predicted_classes_label</span><span class="o">=</span><span class="p">[</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pred_index_list</span><span class="p">]</span>

    <span class="c1"># gt_instances_label=len(gt_classes)</span>
    <span class="c1"># predicted_instances_label=len(predicted_classes)</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GT Classes index range&#39;</span><span class="p">,</span><span class="n">gt_index_list</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred Classes index range&#39;</span><span class="p">,</span><span class="n">pred_index_list</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gt classes: &#39;</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pred classes: &#39;</span><span class="p">,</span><span class="n">predicted_classes</span><span class="p">)</span>


    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes</span><span class="p">):</span>
        <span class="n">indix_range</span><span class="o">=</span><span class="n">pred_index_list</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">indix_range</span><span class="o">=</span><span class="n">gt_index_list</span>

    <span class="n">TP</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1"># for box in gt_boxs:</span>
    <span class="c1">#     print(&#39;Box: &#39;,(box[0.]))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n gt boxs: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n pred boxs: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes</span><span class="p">):</span>
        <span class="n">indix_range</span><span class="o">=</span> <span class="n">gt_index_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indix_range</span><span class="o">=</span><span class="n">pred_index_list</span>


    <span class="n">iou_list</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">)):</span>
            <span class="n">iou</span><span class="o">=</span><span class="n">get_IoU</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">pred_boxs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">iou_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iou</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IoU: &#39;</span><span class="p">,</span><span class="n">iou</span><span class="p">)</span>

            <span class="c1"># for i in indix_range:</span>

            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Car&#39;</span><span class="p">:</span>
                <span class="n">iou_threshold</span><span class="o">=</span><span class="mf">0.7</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iou_threshold</span><span class="o">=</span><span class="mf">0.5</span>

            <span class="k">if</span> <span class="n">iou</span><span class="o">&gt;</span><span class="n">iou_threshold</span><span class="p">:</span>
        
                <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="n">label</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gt_index_list</span> <span class="ow">and</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pred_index_list</span><span class="p">:</span>
                    <span class="n">TP</span><span class="o">=</span><span class="n">TP</span><span class="o">+</span><span class="mi">1</span>
                    <span class="c1">#print(&#39;IoU: &#39;,get_IoU(gt_boxs[counter],pred_boxs[counter]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="n">FP</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes_label</span><span class="p">)</span><span class="o">-</span><span class="n">TP</span>
    <span class="n">FN</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_classes_label</span><span class="p">)</span><span class="o">-</span><span class="n">TP</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IoU List: &#39;</span><span class="p">,</span><span class="n">iou_list</span><span class="p">)</span>

        

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_classes_label</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes_label</span><span class="p">),</span><span class="n">TP</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">FN</span></div>



<div class="viewcode-block" id="get_metrics_label_specific_2"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_metrics_label_specific_2">[docs]</a><span class="k">def</span> <span class="nf">get_metrics_label_specific_2</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="n">predicted_classes</span><span class="p">,</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">pred_boxs</span><span class="p">,</span><span class="n">gt_truncation</span><span class="p">,</span><span class="n">gt_occlusion</span><span class="p">):</span>

    <span class="c1"># Get Labels Count For Groundtruth and Predictions List</span>
    <span class="n">gt_label_count</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">pred_label_count</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">gt_label_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt_classes</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
        <span class="n">pred_label_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predicted_classes</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>

    <span class="n">i</span><span class="o">=</span><span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i: &#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># gt_instances_label=gt_label_count[i]</span>
    <span class="c1"># predicted_instances_label=pred_label_count[i]</span>

    <span class="c1">#print()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Label Count: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predictions Label Count: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class A Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred Class A Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class B Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred Class B Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class C Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred Class C Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    

    <span class="n">gt_index_list</span><span class="o">=</span><span class="n">get_box_difficulty_index_2</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="n">gt_truncation</span><span class="p">,</span><span class="n">gt_occlusion</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">)</span>
    <span class="n">pred_index_list</span><span class="o">=</span><span class="p">[]</span><span class="c1">#get_box_difficulty_index(pred_boxs,predicted_classes,label,difficulty)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicted Class Instances: &#39;</span><span class="p">,</span><span class="n">pred_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1">#print(&#39;Predicted Easy instances: &#39;,len(pred_index_list))</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Class Instances: &#39;</span><span class="p">,</span><span class="n">gt_label_count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gt Easy instances: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_index_list</span><span class="p">))</span>



    <span class="n">gt_classes_label</span><span class="o">=</span><span class="p">[</span><span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gt_index_list</span><span class="p">]</span> 

    

    <span class="c1"># gt_instances_label=len(gt_classes)</span>
    <span class="c1"># predicted_instances_label=len(predicted_classes)</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GT Classes index range&#39;</span><span class="p">,</span><span class="n">gt_index_list</span><span class="p">)</span>
    <span class="c1">#print(&#39;Pred Classes index range&#39;,pred_index_list)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gt classes: &#39;</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pred classes: &#39;</span><span class="p">,</span><span class="n">predicted_classes</span><span class="p">)</span>




    <span class="n">TP</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">FP</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1"># for box in gt_boxs:</span>
    <span class="c1">#     print(&#39;Box: &#39;,(box[0.]))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n gt boxs: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n pred boxs: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">))</span>



    <span class="n">iou_list</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">)):</span>
            <span class="n">iou</span><span class="o">=</span><span class="n">get_IoU</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">pred_boxs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">iou_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iou</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IoU: &#39;</span><span class="p">,</span><span class="n">iou</span><span class="p">)</span>

            <span class="c1"># for i in indix_range:</span>

            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Car&#39;</span><span class="p">:</span>
                <span class="n">iou_threshold</span><span class="o">=</span><span class="mf">0.7</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iou_threshold</span><span class="o">=</span><span class="mf">0.5</span>


            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="n">label</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gt_index_list</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">iou</span><span class="o">&gt;</span><span class="n">iou_threshold</span><span class="p">:</span>
                    <span class="n">TP</span><span class="o">=</span><span class="n">TP</span><span class="o">+</span><span class="mi">1</span>
                    <span class="n">pred_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
                    <span class="c1">#print(&#39;IoU: &#39;,get_IoU(gt_boxs[counter],pred_boxs[counter]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>


    

    <span class="n">difficulty_unidentified_predictions_boxs</span><span class="o">=</span><span class="p">[</span><span class="n">pred_boxs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pred_index_list</span><span class="p">]</span>
    <span class="n">difficulty_unidentified_predictions_classes</span><span class="o">=</span><span class="p">[</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pred_index_list</span><span class="p">]</span>

    <span class="n">identified_predictions_indices_difficulty_by_height</span><span class="o">=</span><span class="n">get_box_difficulty_index</span><span class="p">(</span><span class="n">difficulty_unidentified_predictions_boxs</span><span class="p">,</span><span class="n">difficulty_unidentified_predictions_classes</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">)</span>

    <span class="n">pred_index_list</span><span class="o">=</span><span class="n">pred_index_list</span><span class="o">+</span><span class="n">identified_predictions_indices_difficulty_by_height</span>
    <span class="n">predicted_classes_label</span><span class="o">=</span><span class="p">[</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pred_index_list</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Predictions: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_boxs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Difficulty Specific Predictions: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_index_list</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Difficulty Unidentified Predictions: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">difficulty_unidentified_predictions_boxs</span><span class="p">))</span>

    <span class="n">FP</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes_label</span><span class="p">)</span><span class="o">-</span><span class="n">TP</span>
    <span class="n">FN</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_classes_label</span><span class="p">)</span><span class="o">-</span><span class="n">TP</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IoU List: &#39;</span><span class="p">,</span><span class="n">iou_list</span><span class="p">)</span>

        

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_classes_label</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_classes_label</span><span class="p">),</span><span class="n">TP</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">FN</span></div>


    


<span class="c1"># def visualize_metrics_calculations(gt_ROIs_n,predicted_ROIs_n,TP,FP,FN):</span>
<span class="c1">#     # font</span>
<span class="c1">#     font = cv2.FONT_HERSHEY_SIMPLEX</span>

<span class="c1">#     # org</span>
<span class="c1">#     #org = (int(pt1.x+(box_width/2)),int(pt1.y+(box_height/2)))</span>

<span class="c1">#     # fontScale</span>
<span class="c1">#     fontScale = 1</span>

<span class="c1">#     # Blue color in BGR</span>
<span class="c1">#     red_color = (0,0,255)</span>

<span class="c1">#     # Line thickness of 2 px</span>
<span class="c1">#     thickness = 2</span>

<span class="c1">#     if predicted_ROIs_n==TP+FP:</span>
<span class="c1">#         check_precision=True</span>
<span class="c1">#     else:</span>
<span class="c1">#         check_precision=False</span>

<span class="c1">#     if gt_ROIs_n==TP+FN:</span>
<span class="c1">#         check_recall=True</span>
<span class="c1">#     else:</span>
<span class="c1">#         check_recall=False</span>

    


<span class="c1">#     evaluation_metrics_window=np.zeros((img_height,img_width,3))</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, &#39;# Ground Truth Objects: &#39;+str(gt_ROIs_n), (0,30), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, &#39;# Predicted Objects: &#39;+str(predicted_ROIs_n), (0,60), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, &#39;TP: &#39;+str(TP), (0,90), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, &#39;FP: &#39;+str(FP), (0,120), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, &#39;FN: &#39;+str(FN), (0,150), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     #print(&quot;The band for {} is {} out of 10&quot;.format(name, band))</span>
<span class="c1">#     precision_string_expression=&quot;Precision = TP/(TP+FP) = {} / {}  Check = {}&quot;.format(TP,TP+FP,check_precision)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, precision_string_expression, (0,180), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     recall_string_expression=&quot;Recall = TP/(TP+FN) = {} / {}  Check = {}&quot;.format(TP,TP+FN,check_recall)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, recall_string_expression, (0,210), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, &#39;(TP+FP) = # Predicted Objects&#39;, (0,240), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>
<span class="c1">#     evaluation_metrics_window = cv2.putText(evaluation_metrics_window, &#39;(TP+FN) = # Ground Truth Objects&#39;, (0,270), font, fontScale, red_color, thickness, cv2.LINE_AA)</span>


<span class="c1">#     return evaluation_metrics_window</span>


    

<div class="viewcode-block" id="get_box_difficulty_index"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_box_difficulty_index">[docs]</a><span class="k">def</span> <span class="nf">get_box_difficulty_index</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">):</span>

    <span class="n">easy_difficulty_index_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">moderate_difficulty_index_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">hard_difficulty_index_list</span><span class="o">=</span><span class="p">[]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n gt boxs: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n gt classes: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">))</span>

    <span class="c1">#print(gt_boxs)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">)):</span>
        <span class="n">box_height</span><span class="o">=</span><span class="n">gt_boxs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">gt_boxs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="n">box_height</span><span class="o">&gt;</span><span class="mi">40</span><span class="p">:</span>
            <span class="c1">#easy_difficulty_index_list.append(i)</span>

            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">:</span>
                <span class="n">easy_difficulty_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="mi">25</span><span class="o">&lt;</span><span class="n">box_height</span><span class="o">&lt;</span><span class="mi">40</span><span class="p">:</span>
           <span class="c1"># moderate_difficulty_index_list.append(i)</span>

            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">:</span>
                <span class="n">moderate_difficulty_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">difficulty</span><span class="o">==</span><span class="s1">&#39;Easy&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">easy_difficulty_index_list</span>

    <span class="k">elif</span> <span class="n">difficulty</span><span class="o">==</span><span class="s1">&#39;Moderate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">moderate_difficulty_index_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hard_difficulty_index_list</span></div>


<div class="viewcode-block" id="get_box_difficulty_index_2"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_box_difficulty_index_2">[docs]</a><span class="k">def</span> <span class="nf">get_box_difficulty_index_2</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="n">gt_truncation</span><span class="p">,</span><span class="n">gt_occlusion</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">):</span>

    <span class="n">easy_difficulty_index_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">moderate_difficulty_index_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">hard_difficulty_index_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">dont_care_index_list</span><span class="o">=</span><span class="p">[]</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n gt boxs: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n gt classes: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">))</span>

    <span class="c1">#print(gt_boxs)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">)):</span>
        <span class="n">box_height</span><span class="o">=</span><span class="n">gt_boxs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">gt_boxs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
        <span class="n">truncation</span><span class="o">=</span><span class="n">gt_truncation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">occlusion</span><span class="o">=</span><span class="n">gt_occlusion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">box_height</span><span class="o">&gt;=</span><span class="mi">40</span> <span class="ow">and</span> <span class="n">occlusion</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">truncation</span><span class="o">&lt;=</span><span class="mf">0.15</span><span class="p">:</span>
            <span class="c1">#easy_difficulty_index_list.append(i)</span>

            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">:</span>
                <span class="n">easy_difficulty_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">box_height</span><span class="o">&gt;=</span><span class="mi">25</span> <span class="ow">and</span> <span class="n">occlusion</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">truncation</span><span class="o">&lt;=</span><span class="mf">0.3</span><span class="p">:</span>
           <span class="c1"># moderate_difficulty_index_list.append(i)</span>

            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">:</span>
                <span class="n">moderate_difficulty_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">elif</span> <span class="n">box_height</span><span class="o">&gt;=</span><span class="mi">25</span> <span class="ow">and</span> <span class="n">occlusion</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">truncation</span><span class="o">&lt;=</span><span class="mf">0.5</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">gt_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">:</span>
                <span class="n">hard_difficulty_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">dont_care_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">difficulty</span><span class="o">==</span><span class="s1">&#39;Easy&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">easy_difficulty_index_list</span>

    <span class="k">elif</span> <span class="n">difficulty</span><span class="o">==</span><span class="s1">&#39;Moderate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">moderate_difficulty_index_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hard_difficulty_index_list</span></div>


<div class="viewcode-block" id="tabularize_metrics"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.tabularize_metrics">[docs]</a><span class="k">def</span> <span class="nf">tabularize_metrics</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span><span class="n">gt_total_class_count</span><span class="p">,</span><span class="n">filtered_gt_class_count</span><span class="p">,</span><span class="n">gt_difficulty_class_count</span><span class="p">,</span><span class="n">ignored_gt_count</span><span class="p">,</span><span class="n">pred_total_class_count</span><span class="p">,</span><span class="n">pred_filtered_class_count</span><span class="p">,</span><span class="n">pred_difficulty_class_count</span><span class="p">,</span><span class="n">ignored_pred_count</span><span class="p">,</span><span class="n">n_frames</span><span class="p">,</span><span class="n">path</span><span class="p">):</span>
    <span class="n">TP_A1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">FP_A1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">FN_A1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">TP_A2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">FP_A2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">FN_A2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">TP_A3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">FP_A3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">FN_A3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>


    <span class="n">TP_A_list</span><span class="o">=</span><span class="n">TP_A1_list</span><span class="o">+</span><span class="n">TP_A2_list</span><span class="o">+</span><span class="n">TP_A3_list</span>
    <span class="n">FP_A_list</span><span class="o">=</span><span class="n">FP_A1_list</span><span class="o">+</span><span class="n">FP_A2_list</span><span class="o">+</span><span class="n">FP_A3_list</span>
    <span class="n">FN_A_list</span><span class="o">=</span><span class="n">FN_A1_list</span><span class="o">+</span><span class="n">FN_A2_list</span><span class="o">+</span><span class="n">FN_A3_list</span>

    


    <span class="n">TP_B1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
    <span class="n">FP_B1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">FN_B1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>

    <span class="n">TP_B2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
    <span class="n">FP_B2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">13</span><span class="p">]</span>
    <span class="n">FN_B2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">14</span><span class="p">]</span>

    <span class="n">TP_B3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">FP_B3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">16</span><span class="p">]</span>
    <span class="n">FN_B3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">17</span><span class="p">]</span>

    <span class="n">TP_B_list</span><span class="o">=</span><span class="n">TP_B1_list</span><span class="o">+</span><span class="n">TP_B2_list</span><span class="o">+</span><span class="n">TP_B3_list</span>
    <span class="n">FP_B_list</span><span class="o">=</span><span class="n">FP_B1_list</span><span class="o">+</span><span class="n">FP_B2_list</span><span class="o">+</span><span class="n">FP_B3_list</span>
    <span class="n">FN_B_list</span><span class="o">=</span><span class="n">FN_B1_list</span><span class="o">+</span><span class="n">FN_B2_list</span><span class="o">+</span><span class="n">FN_B3_list</span>

    <span class="n">TP_C1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">18</span><span class="p">]</span>
    <span class="n">FP_C1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">19</span><span class="p">]</span>
    <span class="n">FN_C1_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">20</span><span class="p">]</span>

    <span class="n">TP_C2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">21</span><span class="p">]</span>
    <span class="n">FP_C2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">22</span><span class="p">]</span>
    <span class="n">FN_C2_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">23</span><span class="p">]</span>

    <span class="n">TP_C3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">24</span><span class="p">]</span>
    <span class="n">FP_C3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">25</span><span class="p">]</span>
    <span class="n">FN_C3_list</span><span class="o">=</span><span class="n">data_array</span><span class="p">[:,</span><span class="mi">26</span><span class="p">]</span>

    <span class="n">TP_C_list</span><span class="o">=</span><span class="n">TP_C1_list</span><span class="o">+</span><span class="n">TP_C2_list</span><span class="o">+</span><span class="n">TP_C3_list</span>
    <span class="n">FP_C_list</span><span class="o">=</span><span class="n">FP_C1_list</span><span class="o">+</span><span class="n">FP_C2_list</span><span class="o">+</span><span class="n">FP_C3_list</span>
    <span class="n">FN_C_list</span><span class="o">=</span><span class="n">FN_C1_list</span><span class="o">+</span><span class="n">FN_C2_list</span><span class="o">+</span><span class="n">FN_C3_list</span>

    <span class="n">TP_easy_list</span><span class="o">=</span><span class="n">TP_A1_list</span><span class="o">+</span><span class="n">TP_C1_list</span>
    <span class="n">FP_easy_list</span><span class="o">=</span><span class="n">FP_A1_list</span><span class="o">+</span><span class="n">FP_C1_list</span>
    <span class="n">FN_easy_list</span><span class="o">=</span><span class="n">FN_A1_list</span><span class="o">+</span><span class="n">FN_C1_list</span>


    <span class="n">TP_moderate_list</span><span class="o">=</span><span class="n">TP_A2_list</span><span class="o">+</span><span class="n">TP_C2_list</span>
    <span class="n">FP_moderate_list</span><span class="o">=</span><span class="n">FP_A2_list</span><span class="o">+</span><span class="n">FP_C2_list</span>
    <span class="n">FN_moderate_list</span><span class="o">=</span><span class="n">FN_A2_list</span><span class="o">+</span><span class="n">FN_C2_list</span>

    <span class="n">TP_hard_list</span><span class="o">=</span><span class="n">TP_A3_list</span><span class="o">+</span><span class="n">TP_C3_list</span>
    <span class="n">FP_hard_list</span><span class="o">=</span><span class="n">FP_A3_list</span><span class="o">+</span><span class="n">FP_C3_list</span>
    <span class="n">FN_hard_list</span><span class="o">=</span><span class="n">FN_A3_list</span><span class="o">+</span><span class="n">FN_C3_list</span>

    <span class="n">ΣTP_A1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))]</span>
    <span class="n">ΣFP_A1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_A1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_A1_list</span><span class="p">))]</span>
    <span class="n">ΣFN_A1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_A1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_A1_list</span><span class="p">))]</span>

    <span class="n">ΣTP_A2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_A2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A2_list</span><span class="p">))]</span>
    <span class="n">ΣFP_A2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_A2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_A2_list</span><span class="p">))]</span>
    <span class="n">ΣFN_A2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_A2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_A2_list</span><span class="p">))]</span>

    <span class="n">ΣTP_A3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_A3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A3_list</span><span class="p">))]</span>
    <span class="n">ΣFP_A3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_A3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_A3_list</span><span class="p">))]</span>
    <span class="n">ΣFN_A3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_A3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_A3_list</span><span class="p">))]</span>

    <span class="n">ΣTP_A</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_A_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A_list</span><span class="p">))]</span>
    <span class="n">ΣFP_A</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_A_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_A_list</span><span class="p">))]</span>
    <span class="n">ΣFN_A</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_A_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_A_list</span><span class="p">))]</span>

    <span class="n">ΣTP_B1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_B1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B1_list</span><span class="p">))]</span>
    <span class="n">ΣFP_B1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_B1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_B1_list</span><span class="p">))]</span>
    <span class="n">ΣFN_B1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_B1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_B1_list</span><span class="p">))]</span>

    <span class="n">ΣTP_B2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_B2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B2_list</span><span class="p">))]</span>
    <span class="n">ΣFP_B2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_B2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_B2_list</span><span class="p">))]</span>
    <span class="n">ΣFN_B2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_B2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_B2_list</span><span class="p">))]</span>

    <span class="n">ΣTP_B3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_B3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B3_list</span><span class="p">))]</span>
    <span class="n">ΣFP_B3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_B3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_B3_list</span><span class="p">))]</span>
    <span class="n">ΣFN_B3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_B3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_B3_list</span><span class="p">))]</span>

    <span class="n">ΣTP_B</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_B_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B_list</span><span class="p">))]</span>
    <span class="n">ΣFP_B</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_B_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_B_list</span><span class="p">))]</span>
    <span class="n">ΣFN_B</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_B_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_B_list</span><span class="p">))]</span>

    <span class="n">ΣTP_C1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_C1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C1_list</span><span class="p">))]</span>
    <span class="n">ΣFP_C1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_C1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_C1_list</span><span class="p">))]</span>
    <span class="n">ΣFN_C1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_C1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_C1_list</span><span class="p">))]</span>

    <span class="n">ΣTP_C2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_C2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C2_list</span><span class="p">))]</span>
    <span class="n">ΣFP_C2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_C2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_C2_list</span><span class="p">))]</span>
    <span class="n">ΣFN_C2</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_C2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_C2_list</span><span class="p">))]</span>

    <span class="n">ΣTP_C3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_C3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C3_list</span><span class="p">))]</span>
    <span class="n">ΣFP_C3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_C3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_C3_list</span><span class="p">))]</span>
    <span class="n">ΣFN_C3</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_C3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_C3_list</span><span class="p">))]</span>

    <span class="n">ΣTP_C</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_C_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C_list</span><span class="p">))]</span>
    <span class="n">ΣFP_C</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_C_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_C_list</span><span class="p">))]</span>
    <span class="n">ΣFN_C</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_C_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_C_list</span><span class="p">))]</span>
    <span class="c1">#for element in </span>

    <span class="n">ΣTP_easy</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_easy_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_easy_list</span><span class="p">))]</span>
    <span class="n">ΣFP_easy</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_easy_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_easy_list</span><span class="p">))]</span>
    <span class="n">ΣFN_easy</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_easy_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_easy_list</span><span class="p">))]</span>

    <span class="n">ΣTP_moderate</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_moderate_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_moderate_list</span><span class="p">))]</span>
    <span class="n">ΣFP_moderate</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_moderate_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_moderate_list</span><span class="p">))]</span>
    <span class="n">ΣFN_moderate</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_moderate_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_moderate_list</span><span class="p">))]</span>

    <span class="n">ΣTP_hard</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_hard_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_hard_list</span><span class="p">))]</span>
    <span class="n">ΣFP_hard</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_hard_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_hard_list</span><span class="p">))]</span>
    <span class="n">ΣFN_hard</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_hard_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_hard_list</span><span class="p">))]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Check: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">)</span><span class="o">==</span><span class="n">n_frames</span><span class="p">)</span>
    <span class="n">ΣA1_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">ΣA1_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span>  <span class="p">]</span>

    <span class="n">ΣA2_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣA2_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣA3_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣA3_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣA_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣA_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣB1_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span>  <span class="p">]</span>
    <span class="n">ΣB1_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣB2_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣB2_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣB3_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣB3_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣB_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_B</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣB_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_B</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣC1_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣC1_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣC2_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣC2_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣC3_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣC3_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">ΣC_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_C</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">ΣC_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_C</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">Σeasy_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">Σeasy_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_easy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_easy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_easy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">Σmoderate_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">Σmoderate_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_moderate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">Σhard_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">Σhard_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_hard</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ΣTP_hard</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_hard</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="p">]</span>

    <span class="n">A1_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A1_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A1_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A1_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">A2_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A2_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A2_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A2_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A2_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A2_list</span><span class="p">))]</span>
    <span class="n">A2_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A2_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A2_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">A3_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A3_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A3_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A3_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A3_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A3_list</span><span class="p">))]</span>
    <span class="n">A3_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A3_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A3_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">A_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">A_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A_list</span><span class="p">))]</span>
    <span class="n">A_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">B1_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B1_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B1_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B1_list</span><span class="p">))]</span>
    <span class="n">B1_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">B2_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B2_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B2_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B2_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B2_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B2_list</span><span class="p">))]</span>
    <span class="n">B2_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B2_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B2_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">B3_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B3_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B3_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B3_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B3_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B3_list</span><span class="p">))]</span>
    <span class="n">B3_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B3_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B3_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">B_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">B_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_B_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_B_list</span><span class="p">))]</span>
    <span class="n">B_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">B_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">C1_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C1_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C1_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C1_list</span><span class="p">))]</span>
    <span class="n">C1_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">C2_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C2_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C2_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C2_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C2_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C2_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C2_list</span><span class="p">))]</span>
    <span class="n">C2_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C2_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C2_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">C3_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C3_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C3_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C3_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C3_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C3_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C3_list</span><span class="p">))]</span>
    <span class="n">C3_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C3_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C3_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">C_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>
    <span class="n">C_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">TP_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_C_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_C_list</span><span class="p">))]</span>
    <span class="n">C_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">C_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">C_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)]</span>

    <span class="n">gt_class_A_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">gt_total_class_count</span><span class="p">]</span>
    <span class="n">gt_class_B_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">gt_total_class_count</span><span class="p">]</span>
    <span class="n">gt_class_C_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">gt_total_class_count</span><span class="p">]</span>

    <span class="n">filtered_gt_class_A_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">filtered_gt_class_count</span><span class="p">]</span>
    <span class="n">filtered_gt_class_B_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">filtered_gt_class_count</span><span class="p">]</span>
    <span class="n">filtered_gt_class_C_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">filtered_gt_class_count</span><span class="p">]</span>

    <span class="n">ignored_gt_class_A_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">ignored_gt_count</span><span class="p">]</span>
    <span class="n">ignored_gt_class_B_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">ignored_gt_count</span><span class="p">]</span>
    <span class="n">ignored_gt_class_C_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">ignored_gt_count</span><span class="p">]</span>



    <span class="n">gt_class_A1_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>
    <span class="n">gt_class_A2_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>
    <span class="n">gt_class_A3_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>

    <span class="n">gt_class_B1_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>
    <span class="n">gt_class_B2_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>
    <span class="n">gt_class_B3_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>

    <span class="n">gt_class_C1_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>
    <span class="n">gt_class_C2_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>
    <span class="n">gt_class_C3_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">gt_difficulty_class_count</span><span class="p">]</span>

    <span class="n">pred_class_A_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">pred_total_class_count</span><span class="p">]</span>
    <span class="n">pred_class_B_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">pred_total_class_count</span><span class="p">]</span>
    <span class="n">pred_class_C_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">pred_total_class_count</span><span class="p">]</span>


    <span class="n">filtered_pred_class_A_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">pred_filtered_class_count</span><span class="p">]</span>
    <span class="n">filtered_pred_class_B_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">pred_filtered_class_count</span><span class="p">]</span>
    <span class="n">filtered_pred_class_C_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">pred_filtered_class_count</span><span class="p">]</span>

    <span class="n">ignored_pred_class_A_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">ignored_pred_count</span><span class="p">]</span>
    <span class="n">ignored_pred_class_B_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">ignored_pred_count</span><span class="p">]</span>
    <span class="n">ignored_pred_class_C_count</span><span class="o">=</span><span class="p">[</span><span class="n">class_count</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">class_count</span> <span class="ow">in</span> <span class="n">ignored_pred_count</span><span class="p">]</span>

    <span class="n">pred_class_A1_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>
    <span class="n">pred_class_A2_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>
    <span class="n">pred_class_A3_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>

    <span class="n">pred_class_B1_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>
    <span class="n">pred_class_B2_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>
    <span class="n">pred_class_B3_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>

    <span class="n">pred_class_C1_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>
    <span class="n">pred_class_C2_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>
    <span class="n">pred_class_C3_count</span><span class="o">=</span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">pred_difficulty_class_count</span><span class="p">]</span>

    <span class="n">ΣA_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_A_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_A_count</span><span class="p">))]</span>
    <span class="n">ΣB_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_B_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_B_count</span><span class="p">))]</span>
    <span class="n">ΣC_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_C_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_C_count</span><span class="p">))]</span>

    <span class="n">ΣA_filtered_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">filtered_gt_class_A_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_gt_class_A_count</span><span class="p">))]</span>
    <span class="n">ΣB_filtered_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">filtered_gt_class_B_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_gt_class_B_count</span><span class="p">))]</span>
    <span class="n">ΣC_filtered_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">filtered_gt_class_C_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_gt_class_C_count</span><span class="p">))]</span>

    <span class="n">ΣA1_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_A1_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_A1_count</span><span class="p">))]</span>
    <span class="n">ΣA2_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_A2_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_A2_count</span><span class="p">))]</span>
    <span class="n">ΣA3_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_A3_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_A3_count</span><span class="p">))]</span>

    <span class="n">ΣB1_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_B1_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_B1_count</span><span class="p">))]</span>
    <span class="n">ΣB2_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_B2_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_B2_count</span><span class="p">))]</span>
    <span class="n">ΣB3_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_B3_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_B3_count</span><span class="p">))]</span>

    <span class="n">ΣC1_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_C1_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_C1_count</span><span class="p">))]</span>
    <span class="n">ΣC2_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_C2_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_C2_count</span><span class="p">))]</span>
    <span class="n">ΣC3_gt_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">gt_class_C3_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gt_class_C3_count</span><span class="p">))]</span>

    <span class="n">ΣA_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_A_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_A_count</span><span class="p">))]</span>
    <span class="n">ΣB_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_B_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_B_count</span><span class="p">))]</span>
    <span class="n">ΣC_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_C_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_C_count</span><span class="p">))]</span>

    <span class="n">ΣA1_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_A1_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_A1_count</span><span class="p">))]</span>
    <span class="n">ΣA2_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_A2_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_A2_count</span><span class="p">))]</span>
    <span class="n">ΣA3_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_A3_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_A3_count</span><span class="p">))]</span>

    <span class="n">ΣB1_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_B1_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_B1_count</span><span class="p">))]</span>
    <span class="n">ΣB2_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_B2_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_B2_count</span><span class="p">))]</span>
    <span class="n">ΣB3_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_B3_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_B3_count</span><span class="p">))]</span>

    <span class="n">ΣC1_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_C1_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_C1_count</span><span class="p">))]</span>
    <span class="n">ΣC2_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_C2_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_C2_count</span><span class="p">))]</span>
    <span class="n">ΣC3_pred_count</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pred_class_C2_count</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_class_C2_count</span><span class="p">))]</span>

    

    <span class="n">classA1_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_A1_list</span><span class="p">,</span><span class="n">FP_A1_list</span><span class="p">,</span><span class="n">FN_A1_list</span><span class="p">,</span><span class="n">A1_frame_precision</span><span class="p">,</span><span class="n">A1_frame_recall</span><span class="p">,</span><span class="n">ΣTP_A1</span><span class="p">,</span><span class="n">ΣFP_A1</span><span class="p">,</span><span class="n">ΣFN_A1</span><span class="p">,</span><span class="n">ΣA1_precision</span><span class="p">,</span><span class="n">ΣA1_recall</span><span class="p">,</span><span class="n">A1_mean_precision</span><span class="p">,</span><span class="n">A1_mean_recall</span><span class="p">))</span>
    <span class="n">classA1_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classA1_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classA1_data,os.path.join(path,&#39;Cars Easy.png&#39;),max_rows=-1)</span>
    <span class="n">classA1_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cars Easy.xlsx&#39;</span><span class="p">))</span>

    <span class="c1"># print(&quot;ΣA1_precision[-1]: &quot;,ΣA1_precision[-1])</span>
    <span class="c1"># print(&quot;ΣA1_recall[-1]: &quot;,ΣA1_recall[-1])</span>

    <span class="c1"># print(&quot;ΣA1_recall: \n&quot;,ΣA1_recall)</span>
    <span class="c1"># print(&quot;len(ΣA1_recall): &quot;,len(ΣA1_recall))</span>
    <span class="n">classA2_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_A2_list</span><span class="p">,</span><span class="n">FP_A2_list</span><span class="p">,</span><span class="n">FN_A2_list</span><span class="p">,</span><span class="n">A2_frame_precision</span><span class="p">,</span><span class="n">A2_frame_recall</span><span class="p">,</span><span class="n">ΣTP_A2</span><span class="p">,</span><span class="n">ΣFP_A2</span><span class="p">,</span><span class="n">ΣFN_A2</span><span class="p">,</span><span class="n">ΣA2_precision</span><span class="p">,</span><span class="n">ΣA2_recall</span><span class="p">,</span><span class="n">A2_mean_precision</span><span class="p">,</span><span class="n">A2_mean_recall</span><span class="p">))</span>
    <span class="n">classA2_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classA2_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classA2_data,os.path.join(path,&#39;Cars Moderate.png&#39;),max_rows=-1)</span>
    <span class="n">classA2_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cars Moderate.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classA3_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_A3_list</span><span class="p">,</span><span class="n">FP_A3_list</span><span class="p">,</span><span class="n">FN_A3_list</span><span class="p">,</span><span class="n">A3_frame_precision</span><span class="p">,</span><span class="n">A3_frame_recall</span><span class="p">,</span><span class="n">ΣTP_A3</span><span class="p">,</span><span class="n">ΣFP_A3</span><span class="p">,</span><span class="n">ΣFN_A3</span><span class="p">,</span><span class="n">ΣA3_precision</span><span class="p">,</span><span class="n">ΣA3_recall</span><span class="p">,</span><span class="n">A3_mean_precision</span><span class="p">,</span><span class="n">A3_mean_recall</span><span class="p">))</span>
    <span class="n">classA3_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classA3_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classA3_data,os.path.join(path,&#39;Cars Moderate.png&#39;),max_rows=-1)</span>
    <span class="n">classA3_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cars Hard.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classA_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_A_list</span><span class="p">,</span><span class="n">FP_A_list</span><span class="p">,</span><span class="n">FN_A_list</span><span class="p">,</span><span class="n">A_frame_precision</span><span class="p">,</span><span class="n">A_frame_recall</span><span class="p">,</span><span class="n">ΣTP_A</span><span class="p">,</span><span class="n">ΣFP_A</span><span class="p">,</span><span class="n">ΣFN_A</span><span class="p">,</span><span class="n">ΣA_precision</span><span class="p">,</span><span class="n">ΣA_recall</span><span class="p">,</span><span class="n">A_mean_precision</span><span class="p">,</span><span class="n">A_mean_recall</span><span class="p">))</span>
    <span class="n">classA_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classA_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classA_data,os.path.join(path,&#39;Cars Moderate.png&#39;),max_rows=-1)</span>
    <span class="n">classA_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cars Overall.xlsx&#39;</span><span class="p">))</span>

    

    <span class="n">classB1_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_B1_list</span><span class="p">,</span><span class="n">FP_B1_list</span><span class="p">,</span><span class="n">FN_B1_list</span><span class="p">,</span><span class="n">B1_frame_precision</span><span class="p">,</span><span class="n">B1_frame_recall</span><span class="p">,</span><span class="n">ΣTP_B1</span><span class="p">,</span><span class="n">ΣFP_B1</span><span class="p">,</span><span class="n">ΣFN_B1</span><span class="p">,</span><span class="n">ΣB1_precision</span><span class="p">,</span><span class="n">ΣB1_recall</span><span class="p">,</span><span class="n">B1_mean_precision</span><span class="p">,</span><span class="n">B1_mean_recall</span><span class="p">))</span>
    <span class="n">classB1_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classB1_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classB1_data,os.path.join(path,&#39;Cyclists Easy.png&#39;),max_rows=-1)</span>
    <span class="n">classB1_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cyclists Easy.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classB2_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_B2_list</span><span class="p">,</span><span class="n">FP_B2_list</span><span class="p">,</span><span class="n">FN_B2_list</span><span class="p">,</span><span class="n">B2_frame_precision</span><span class="p">,</span><span class="n">B2_frame_recall</span><span class="p">,</span><span class="n">ΣTP_B2</span><span class="p">,</span><span class="n">ΣFP_B2</span><span class="p">,</span><span class="n">ΣFN_B2</span><span class="p">,</span><span class="n">ΣB2_precision</span><span class="p">,</span><span class="n">ΣB2_recall</span><span class="p">,</span><span class="n">B2_mean_precision</span><span class="p">,</span><span class="n">B2_mean_recall</span><span class="p">))</span>
    <span class="n">classB2_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classB2_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classB2_data,os.path.join(path,&#39;Cyclists Moderate.png&#39;),max_rows=-1)</span>
    <span class="n">classB2_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cyclists Moderate.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classB3_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_B3_list</span><span class="p">,</span><span class="n">FP_B3_list</span><span class="p">,</span><span class="n">FN_B3_list</span><span class="p">,</span><span class="n">B3_frame_precision</span><span class="p">,</span><span class="n">B3_frame_recall</span><span class="p">,</span><span class="n">ΣTP_B3</span><span class="p">,</span><span class="n">ΣFP_B3</span><span class="p">,</span><span class="n">ΣFN_B3</span><span class="p">,</span><span class="n">ΣB3_precision</span><span class="p">,</span><span class="n">ΣB3_recall</span><span class="p">,</span><span class="n">B3_mean_precision</span><span class="p">,</span><span class="n">B3_mean_recall</span><span class="p">))</span>
    <span class="n">classB3_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classB3_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classB3_data,os.path.join(path,&#39;Cyclists Moderate.png&#39;),max_rows=-1)</span>
    <span class="n">classB3_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cyclists Hard.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classB_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_B_list</span><span class="p">,</span><span class="n">FP_B_list</span><span class="p">,</span><span class="n">FN_B_list</span><span class="p">,</span><span class="n">B_frame_precision</span><span class="p">,</span><span class="n">B_frame_recall</span><span class="p">,</span><span class="n">ΣTP_B</span><span class="p">,</span><span class="n">ΣFP_B</span><span class="p">,</span><span class="n">ΣFN_B</span><span class="p">,</span><span class="n">ΣB_precision</span><span class="p">,</span><span class="n">ΣB_recall</span><span class="p">,</span><span class="n">B_mean_precision</span><span class="p">,</span><span class="n">B_mean_recall</span><span class="p">))</span>
    <span class="n">classB_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classB_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classB_data,os.path.join(path,&#39;Cars Moderate.png&#39;),max_rows=-1)</span>
    <span class="n">classB_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cyclists Overall.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classC1_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_C1_list</span><span class="p">,</span><span class="n">FP_C1_list</span><span class="p">,</span><span class="n">FN_C1_list</span><span class="p">,</span><span class="n">C1_frame_precision</span><span class="p">,</span><span class="n">C1_frame_recall</span><span class="p">,</span><span class="n">ΣTP_C1</span><span class="p">,</span><span class="n">ΣFP_C1</span><span class="p">,</span><span class="n">ΣFN_C1</span><span class="p">,</span><span class="n">ΣC1_precision</span><span class="p">,</span><span class="n">ΣC1_recall</span><span class="p">,</span><span class="n">C1_mean_precision</span><span class="p">,</span><span class="n">C1_mean_recall</span><span class="p">))</span>
    <span class="n">classC1_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classC1_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classC1_data,os.path.join(path,&#39;Pedestrian Easy.png&#39;),max_rows=-1)</span>
    <span class="n">classC1_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Pedestrian Easy.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classC2_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_C2_list</span><span class="p">,</span><span class="n">FP_C2_list</span><span class="p">,</span><span class="n">FN_C2_list</span><span class="p">,</span><span class="n">C2_frame_precision</span><span class="p">,</span><span class="n">C2_frame_recall</span><span class="p">,</span><span class="n">ΣTP_C2</span><span class="p">,</span><span class="n">ΣFP_C2</span><span class="p">,</span><span class="n">ΣFN_C2</span><span class="p">,</span><span class="n">ΣC2_precision</span><span class="p">,</span><span class="n">ΣC2_recall</span><span class="p">,</span><span class="n">C2_mean_precision</span><span class="p">,</span><span class="n">C2_mean_recall</span><span class="p">))</span>
    <span class="n">classC2_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classC2_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classC2_data,os.path.join(path,&#39;Pedestrian Hard.png&#39;),max_rows=-1)</span>
    <span class="n">classC2_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Pedestrian Hard.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classC3_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_C3_list</span><span class="p">,</span><span class="n">FP_C3_list</span><span class="p">,</span><span class="n">FN_C3_list</span><span class="p">,</span><span class="n">C3_frame_precision</span><span class="p">,</span><span class="n">C3_frame_recall</span><span class="p">,</span><span class="n">ΣTP_C3</span><span class="p">,</span><span class="n">ΣFP_C3</span><span class="p">,</span><span class="n">ΣFN_C3</span><span class="p">,</span><span class="n">ΣC3_precision</span><span class="p">,</span><span class="n">ΣC3_recall</span><span class="p">,</span><span class="n">C3_mean_precision</span><span class="p">,</span><span class="n">C3_mean_recall</span><span class="p">))</span>
    <span class="n">classC3_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classC3_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classC3_data,os.path.join(path,&#39;Pedestrian Hard.png&#39;),max_rows=-1)</span>
    <span class="n">classC3_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Pedestrian Hard.xlsx&#39;</span><span class="p">))</span>

    <span class="n">classC_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_C_list</span><span class="p">,</span><span class="n">FP_C_list</span><span class="p">,</span><span class="n">FN_C_list</span><span class="p">,</span><span class="n">C_frame_precision</span><span class="p">,</span><span class="n">C_frame_recall</span><span class="p">,</span><span class="n">ΣTP_C</span><span class="p">,</span><span class="n">ΣFP_C</span><span class="p">,</span><span class="n">ΣFN_C</span><span class="p">,</span><span class="n">ΣC_precision</span><span class="p">,</span><span class="n">ΣC_recall</span><span class="p">,</span><span class="n">C_mean_precision</span><span class="p">,</span><span class="n">C_mean_recall</span><span class="p">))</span>
    <span class="n">classC_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classC_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="c1">#dfi.export(classC_data,os.path.join(path,&#39;Cars Moderate.png&#39;),max_rows=-1)</span>
    <span class="n">classC_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Pedestrians Overall.xlsx&#39;</span><span class="p">))</span>

    <span class="c1">#table_data=table_data.style.set_table_styles([{&quot;selector&quot;:&quot;thead&quot;,&quot;props&quot;:&quot;font-size:20pt&quot;}])</span>
<span class="c1">#     table_data = table_data.data.style.set_properties(**{</span>
<span class="c1">#     &#39;font-size&#39;: &#39;30pt&#39;,</span>
<span class="c1"># })</span>
    <span class="c1">#</span>
    <span class="c1"># Checks</span>

    <span class="c1"># All Data in Table + Checks</span>
    <span class="n">A_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">classA1_array</span><span class="p">,</span><span class="n">classA2_array</span><span class="p">,</span><span class="n">classA3_array</span><span class="p">,</span><span class="n">classA_array</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#,classB1_array,classB2_array,classC1_array,classC2_array))</span>
    <span class="n">A_array_with_checks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">A_array</span><span class="p">,</span><span class="n">gt_class_A_count</span><span class="p">,</span><span class="n">filtered_gt_class_A_count</span><span class="p">,</span><span class="n">gt_class_A1_count</span><span class="p">,</span><span class="n">gt_class_A2_count</span><span class="p">,</span><span class="n">gt_class_A3_count</span><span class="p">,</span><span class="n">ignored_gt_class_A_count</span><span class="p">,</span><span class="n">pred_class_A_count</span><span class="p">,</span><span class="n">filtered_pred_class_A_count</span><span class="p">,</span><span class="n">pred_class_A1_count</span><span class="p">,</span><span class="n">pred_class_A2_count</span><span class="p">,</span><span class="n">pred_class_A3_count</span><span class="p">,</span><span class="n">ignored_pred_class_A_count</span><span class="p">,</span><span class="n">ΣA_gt_count</span><span class="p">,</span><span class="n">ΣA_filtered_gt_count</span><span class="p">,</span><span class="n">ΣA1_gt_count</span><span class="p">,</span><span class="n">ΣA2_gt_count</span><span class="p">,</span><span class="n">ΣA3_gt_count</span><span class="p">,</span><span class="n">ΣA_pred_count</span><span class="p">,</span><span class="n">ΣA1_pred_count</span><span class="p">,</span><span class="n">ΣA2_pred_count</span><span class="p">,</span><span class="n">ΣA3_pred_count</span><span class="p">))</span>
    <span class="n">A_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">A_array_with_checks</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">field_name_cars</span><span class="p">)</span>
    <span class="n">A_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cars.xlsx&#39;</span><span class="p">),</span><span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;metrics&#39;</span><span class="p">)</span>
    <span class="c1">#dfi.export(A_data,os.path.join(path,&#39;Cars.png&#39;),max_rows=-1,max_cols=-1)</span>

    <span class="c1"># Customize Worksheet</span>

    <span class="n">enhance_excelfile</span><span class="p">(</span><span class="n">A_data</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Enhanced_Cars.xlsx&#39;</span><span class="p">)</span>


    <span class="c1"># writer = pd.ExcelWriter(os.path.join(path,&#39;enhanced_Cars.xlsx&#39;), engine=&#39;xlsxwriter&#39;)</span>
    <span class="c1"># A_data.to_excel(writer, index=False, sheet_name=&#39;metrics&#39;)</span>
    <span class="c1"># #</span>
    <span class="c1"># workbook = writer.book</span>
    <span class="c1"># worksheet = writer.sheets[&#39;metrics&#39;]</span>


    <span class="c1"># #Set header formating</span>
    <span class="c1"># header_format = workbook.add_format({</span>
    <span class="c1">#         &quot;valign&quot;: &quot;vcenter&quot;,</span>
    <span class="c1">#         &quot;align&quot;: &quot;center&quot;,</span>
    <span class="c1">#         &quot;bg_color&quot;: &quot;#951F06&quot;,</span>
    <span class="c1">#         &quot;bold&quot;: True,</span>
    <span class="c1">#         &#39;font_color&#39;: &#39;#FFFFFF&#39;</span>
    <span class="c1">#     })</span>

    

    <span class="c1"># #add title</span>
    <span class="c1"># #merge cells</span>
    <span class="c1"># # format = workbook.add_format()</span>
    <span class="c1"># # format.set_font_size(30)</span>
    <span class="c1"># # format.set_font_color(&quot;#333333&quot;)</span>
    <span class="c1"># #worksheet.merge_range(&#39;A1:AS1&#39;, title, format)</span>
    <span class="c1"># # puting it all together</span>
    <span class="c1"># # Write the column headers with the defined format.</span>
    <span class="c1"># # for col_num, col_value in enumerate(A_data.columns.values):</span>
    <span class="c1"># #     #print(col_num, value)</span>
    <span class="c1"># #     #for row_num,row_value in enumerate(A_data.rows.values):</span>
    <span class="c1"># #     worksheet.write(4, col_num, col_value)</span>

    <span class="c1"># easy_cols=[&#39;A&#39;,&#39;B&#39;,&#39;C&#39;]</span>
    <span class="c1"># moderate_cols=[&#39;M&#39;,&#39;N&#39;,&#39;O&#39;]</span>
    <span class="c1"># hard_cols=[&#39;Y&#39;,&#39;Z&#39;,&#39;AA&#39;]</span>
 

    <span class="c1"># total_cols=easy_cols+moderate_cols+hard_cols</span>

    <span class="c1"># easy_format = workbook.add_format({&#39;bg_color&#39;: &#39;blue&#39;})</span>
    <span class="c1"># moderate_format=workbook.add_format({&#39;bg_color&#39;: &#39;purple&#39;})</span>
    <span class="c1"># hard_format=workbook.add_format({&#39;bg_color&#39;: &#39;orange&#39;})</span>

    <span class="c1"># gt_stats_format=workbook.add_format({&#39;bg_color&#39;: &#39;green&#39;})</span>
    <span class="c1"># pred_stats_format=workbook.add_format({&#39;bg_color&#39;: &#39;red&#39;})</span>
    
    <span class="c1"># worksheet.set_column(&#39;A1:C1&#39;, None, easy_format)</span>
    <span class="c1"># worksheet.set_column(12, 14, None, moderate_format)</span>
    <span class="c1"># worksheet.set_column(24, 26, None, hard_format)</span>

    <span class="c1"># worksheet.set_column(36, 41, None, gt_stats_format)</span>
    <span class="c1"># worksheet.set_column(42, 47, None, pred_stats_format)</span>




    <span class="c1"># # Adjust the column width.</span>
    <span class="c1"># worksheet.set_column(&#39;A:BF&#39;, 30)</span>



    <span class="c1"># writer.save()</span>





    <span class="c1"># All Data in Table + Checks</span>
    <span class="n">B_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">classB1_array</span><span class="p">,</span><span class="n">classB2_array</span><span class="p">,</span><span class="n">classB3_array</span><span class="p">,</span><span class="n">classB_array</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#,classB1_array,classB2_array,classC1_array,classC2_array))</span>
    <span class="n">B_array_with_checks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">B_array</span><span class="p">,</span><span class="n">gt_class_B_count</span><span class="p">,</span><span class="n">filtered_gt_class_B_count</span><span class="p">,</span><span class="n">gt_class_B1_count</span><span class="p">,</span><span class="n">gt_class_B2_count</span><span class="p">,</span><span class="n">gt_class_B3_count</span><span class="p">,</span><span class="n">ignored_gt_class_B_count</span><span class="p">,</span><span class="n">pred_class_B_count</span><span class="p">,</span><span class="n">filtered_pred_class_B_count</span><span class="p">,</span><span class="n">pred_class_B1_count</span><span class="p">,</span><span class="n">pred_class_B2_count</span><span class="p">,</span><span class="n">pred_class_B3_count</span><span class="p">,</span><span class="n">ignored_pred_class_B_count</span><span class="p">,</span><span class="n">ΣB_gt_count</span><span class="p">,</span><span class="n">ΣB_filtered_gt_count</span><span class="p">,</span><span class="n">ΣB1_gt_count</span><span class="p">,</span><span class="n">ΣB2_gt_count</span><span class="p">,</span><span class="n">ΣB3_gt_count</span><span class="p">,</span><span class="n">ΣB_pred_count</span><span class="p">,</span><span class="n">ΣB1_pred_count</span><span class="p">,</span><span class="n">ΣB2_pred_count</span><span class="p">,</span><span class="n">ΣB3_pred_count</span><span class="p">))</span>
    <span class="n">B_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">B_array_with_checks</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">field_name_cyclists</span><span class="p">)</span>
    <span class="n">B_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Cyclists.xlsx&#39;</span><span class="p">))</span>
    <span class="c1">#dfi.export(A_data,os.path.join(path,&#39;Cars.png&#39;),max_rows=-1,max_cols=-1)</span>

    <span class="n">enhance_excelfile</span><span class="p">(</span><span class="n">B_data</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Enhanced_Cyclists.xlsx&#39;</span><span class="p">)</span>

    <span class="c1"># All Data in Table + Checks</span>
    <span class="n">C_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">classC1_array</span><span class="p">,</span><span class="n">classC2_array</span><span class="p">,</span><span class="n">classC3_array</span><span class="p">,</span><span class="n">classC_array</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#,classC1_array,classC2_array,classC1_array,classC2_array))</span>
    <span class="n">C_array_with_checks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">C_array</span><span class="p">,</span><span class="n">gt_class_C_count</span><span class="p">,</span><span class="n">filtered_gt_class_C_count</span><span class="p">,</span><span class="n">gt_class_C1_count</span><span class="p">,</span><span class="n">gt_class_C2_count</span><span class="p">,</span><span class="n">gt_class_C3_count</span><span class="p">,</span><span class="n">ignored_gt_class_C_count</span><span class="p">,</span><span class="n">pred_class_C_count</span><span class="p">,</span><span class="n">filtered_pred_class_C_count</span><span class="p">,</span><span class="n">pred_class_C1_count</span><span class="p">,</span><span class="n">pred_class_C2_count</span><span class="p">,</span><span class="n">pred_class_C3_count</span><span class="p">,</span><span class="n">ignored_pred_class_C_count</span><span class="p">,</span><span class="n">ΣC_gt_count</span><span class="p">,</span><span class="n">ΣC_filtered_gt_count</span><span class="p">,</span><span class="n">ΣC1_gt_count</span><span class="p">,</span><span class="n">ΣC2_gt_count</span><span class="p">,</span><span class="n">ΣC3_gt_count</span><span class="p">,</span><span class="n">ΣC_pred_count</span><span class="p">,</span><span class="n">ΣC1_pred_count</span><span class="p">,</span><span class="n">ΣC2_pred_count</span><span class="p">,</span><span class="n">ΣC3_pred_count</span><span class="p">))</span>
    <span class="n">C_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">C_array_with_checks</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">field_name_pedestrians</span><span class="p">)</span>
    <span class="n">C_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Pedestrians.xlsx&#39;</span><span class="p">))</span>

    <span class="n">enhance_excelfile</span><span class="p">(</span><span class="n">C_data</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;Enhanced_Pedestrians.xlsx&#39;</span><span class="p">)</span>


    <span class="c1"># B_array=np.concatenate((classB1_array,classB2_array),axis=1)#,classB1_array,classB2_array,classC1_array,classC2_array))</span>
    <span class="c1"># B_array_with_checks=np.column_stack((B_array,gt_class_B_count,gt_class_B1_count,gt_class_B2_count,pred_class_B_count,pred_class_B1_count,pred_class_B2_count,ΣB_gt_count,ΣB1_gt_count,ΣB2_gt_count,ΣB_pred_count,ΣB1_pred_count,ΣB2_pred_count))</span>
    <span class="c1"># B_data=pd.DataFrame(B_array_with_checks,columns=field_name_cyclists)</span>
    <span class="c1"># B_data.to_excel(os.path.join(path,&#39;Cyclists.xlsx&#39;))</span>
    <span class="c1"># #dfi.export(B_data,os.path.join(path,&#39;Cyclists.png&#39;),max_rows=-1,max_cols=-1)</span>

    <span class="c1"># C_array=np.concatenate((classC1_array,classC2_array),axis=1)#,classB1_array,classB2_array,classC1_array,classC2_array))</span>
    <span class="c1"># C_array_with_checks=np.column_stack((C_array,gt_class_C_count,gt_class_C1_count,gt_class_C2_count,pred_class_B_count,pred_class_C1_count,pred_class_C2_count,ΣC_gt_count,ΣC1_gt_count,ΣC2_gt_count,ΣC_pred_count,ΣC1_pred_count,ΣC2_pred_count))</span>
    <span class="c1"># C_data=pd.DataFrame(C_array_with_checks,columns=field_name_pedestrians)</span>
    <span class="c1"># C_data.to_excel(os.path.join(path,&#39;Pedestrians.xlsx&#39;))</span>
    <span class="c1"># #dfi.export(C_data,os.path.join(path,&#39;Pedestrians.png&#39;),max_rows=-1,max_cols=-1)</span>

    <span class="n">car_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">ΣA1_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA1_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA2_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA2_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA3_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA3_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">pedestrian_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">ΣC1_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC1_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC2_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC2_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC3_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC3_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">cyclist_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">ΣC1_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC1_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC2_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC2_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC3_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC3_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">difficulty_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">Σeasy_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Σeasy_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Σmoderate_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Σmoderate_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Σhard_precision</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Σhard_recall</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1">#print(&quot;Car Metrics: &quot;,car_metrics)</span>
    <span class="n">easy_objects_count</span><span class="o">=</span><span class="n">ΣA1_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ΣC1_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">moderate_objects_count</span><span class="o">=</span><span class="n">ΣA2_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ΣC2_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">hard_objects_count</span><span class="o">=</span><span class="n">ΣA3_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ΣC3_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">overall_difficulty_objects_count</span><span class="o">=</span><span class="n">ΣA_filtered_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ΣC_filtered_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">#ΣA_gt_count[-1]+ΣC_gt_count[-1]</span>

    <span class="n">n_objects_difficulty</span><span class="o">=</span><span class="p">[</span><span class="n">easy_objects_count</span><span class="p">,</span><span class="n">moderate_objects_count</span><span class="p">,</span><span class="n">hard_objects_count</span><span class="p">,</span><span class="n">overall_difficulty_objects_count</span><span class="p">]</span>
    <span class="n">n_objects_classes</span><span class="o">=</span><span class="p">[</span><span class="n">ΣA1_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA2_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA3_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣA_filtered_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC1_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC2_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC3_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ΣC_filtered_gt_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

    <span class="k">return</span> <span class="n">car_metrics</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">,</span><span class="n">cyclist_metrics</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">,</span><span class="n">n_objects_classes</span><span class="p">,</span><span class="n">n_objects_difficulty</span></div>

<div class="viewcode-block" id="enhance_excelfile"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.enhance_excelfile">[docs]</a><span class="k">def</span> <span class="nf">enhance_excelfile</span><span class="p">(</span><span class="n">class_data</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">enhanced_filename</span><span class="p">):</span>

    <span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">enhanced_filename</span><span class="p">),</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>
    <span class="n">class_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;metrics&#39;</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
    <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">]</span>

    <span class="c1"># Adjust the column width.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:BQ&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>


    <span class="c1">#Set header formating</span>
    <span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s2">&quot;valign&quot;</span><span class="p">:</span> <span class="s2">&quot;vcenter&quot;</span><span class="p">,</span>
            <span class="s2">&quot;align&quot;</span><span class="p">:</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bg_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#951F06&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bold&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFFF&#39;</span>
        <span class="p">})</span>

    



    <span class="n">easy_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
    <span class="n">moderate_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">]</span>
    <span class="n">hard_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;AA&#39;</span><span class="p">]</span>
 

    <span class="n">total_cols</span><span class="o">=</span><span class="n">easy_cols</span><span class="o">+</span><span class="n">moderate_cols</span><span class="o">+</span><span class="n">hard_cols</span>

    <span class="n">easy_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">})</span>
    <span class="n">moderate_format</span><span class="o">=</span><span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">})</span>
    <span class="n">hard_format</span><span class="o">=</span><span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">})</span>

    <span class="n">gt_stats_format</span><span class="o">=</span><span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">})</span>
    <span class="n">pred_stats_format</span><span class="o">=</span><span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">})</span>
    
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A1:C1&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">easy_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;M1:O1&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">moderate_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;Y1:AA1&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">hard_format</span><span class="p">)</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;AK1:AP1&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">gt_stats_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;AQ1:AV1&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">pred_stats_format</span><span class="p">)</span>




    <span class="c1"># Adjust the column width.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:BQ&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>



    <span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>
    

<div class="viewcode-block" id="tabularize"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.tabularize">[docs]</a><span class="k">def</span> <span class="nf">tabularize</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">,</span><span class="n">FP_A1_list</span><span class="p">,</span><span class="n">FN_A1_list</span><span class="p">,</span><span class="n">table_name</span><span class="p">):</span>
    
    <span class="n">ΣTP_A1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))]</span>
    <span class="n">ΣFP_A1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FP_A1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FP_A1_list</span><span class="p">))]</span>
    <span class="n">ΣFN_A1</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">FN_A1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FN_A1_list</span><span class="p">))]</span>



    <span class="n">ΣA1_precision</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))]</span>
    <span class="n">ΣA1_recall</span><span class="o">=</span><span class="p">[</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="p">(</span><span class="n">ΣTP_A1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ΣFN_A1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))</span>  <span class="p">]</span>


    <span class="n">A1_frame_precision</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))]</span>
    <span class="n">A1_mean_precision</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A1_frame_precision</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))]</span>
    <span class="n">A1_frame_recall</span><span class="o">=</span><span class="p">[</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="p">(</span><span class="n">TP_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">FN_A1_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))]</span>
    <span class="n">A1_mean_recall</span><span class="o">=</span><span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">A1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">A1_frame_recall</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TP_A1_list</span><span class="p">))]</span>


    <span class="n">classA1_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">TP_A1_list</span><span class="p">,</span><span class="n">FP_A1_list</span><span class="p">,</span><span class="n">FN_A1_list</span><span class="p">,</span><span class="n">A1_frame_precision</span><span class="p">,</span><span class="n">A1_frame_recall</span><span class="p">,</span><span class="n">ΣTP_A1</span><span class="p">,</span><span class="n">ΣFP_A1</span><span class="p">,</span><span class="n">ΣFN_A1</span><span class="p">,</span><span class="n">ΣA1_precision</span><span class="p">,</span><span class="n">ΣA1_recall</span><span class="p">,</span><span class="n">A1_mean_precision</span><span class="p">,</span><span class="n">A1_mean_recall</span><span class="p">))</span>
    <span class="n">classA1_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">classA1_array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Frame Recall&#39;</span><span class="p">,</span><span class="s1">&#39;ΣTP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFP&#39;</span><span class="p">,</span><span class="s1">&#39;ΣFN&#39;</span><span class="p">,</span><span class="s1">&#39;ΣPrecision&#39;</span><span class="p">,</span><span class="s1">&#39;ΣRecall&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Precision&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Recall&#39;</span><span class="p">])</span>
    <span class="n">dfi</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">classA1_data</span><span class="p">,</span><span class="s2">&quot;/home/hasan/perception-validation-verification/unit_test_figs/&quot;</span><span class="o">+</span><span class="n">table_name</span><span class="o">+</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span></div>




<div class="viewcode-block" id="get_gt_classes_boxes"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_gt_classes_boxes">[docs]</a><span class="k">def</span> <span class="nf">get_gt_classes_boxes</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">):</span>
    <span class="n">gt_classes</span><span class="o">=</span><span class="p">[</span><span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="k">for</span> <span class="n">groundtruth_detection_list</span> <span class="ow">in</span> <span class="n">groundtruth</span> <span class="k">if</span> <span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;DontCare&#39;</span><span class="p">]</span>
    <span class="n">gt_boxs</span><span class="o">=</span><span class="p">[(</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">5</span><span class="p">])),</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">7</span><span class="p">])))</span> <span class="k">for</span> <span class="n">groundtruth_detection_list</span> <span class="ow">in</span> <span class="n">groundtruth</span> <span class="k">if</span> <span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;DontCare&#39;</span> <span class="p">]</span>

    <span class="k">return</span> <span class="n">gt_classes</span><span class="p">,</span><span class="n">gt_boxs</span></div>

<div class="viewcode-block" id="get_gt_truncation_occlusion"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_gt_truncation_occlusion">[docs]</a><span class="k">def</span> <span class="nf">get_gt_truncation_occlusion</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">):</span>
    <span class="n">gt_truncation</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="k">for</span> <span class="n">groundtruth_detection_list</span> <span class="ow">in</span> <span class="n">groundtruth</span> <span class="k">if</span> <span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;DontCare&#39;</span><span class="p">]</span>
    <span class="n">gt_occlusion</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="k">for</span> <span class="n">groundtruth_detection_list</span> <span class="ow">in</span> <span class="n">groundtruth</span> <span class="k">if</span> <span class="n">groundtruth_detection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;DontCare&#39;</span><span class="p">]</span>
    
    

    <span class="k">return</span> <span class="n">gt_truncation</span><span class="p">,</span><span class="n">gt_occlusion</span></div>

<div class="viewcode-block" id="get_pred_classes_boxes"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_pred_classes_boxes">[docs]</a><span class="k">def</span> <span class="nf">get_pred_classes_boxes</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">):</span>
    <span class="n">pred_classes</span><span class="o">=</span><span class="p">[</span><span class="n">yolo_get_key</span><span class="p">(</span><span class="n">prediction_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="nb">list</span> <span class="k">else</span> <span class="n">smoke_predictions_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">prediction_list</span> <span class="ow">in</span> <span class="n">smoke_predictions_list</span><span class="p">]</span>
    <span class="n">pred_boxs</span><span class="o">=</span><span class="p">[(</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction_list</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction_list</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>  <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="nb">list</span> <span class="k">else</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>  <span class="k">for</span> <span class="n">prediction_list</span> <span class="ow">in</span> <span class="n">smoke_predictions_list</span> <span class="p">]</span>

    
    <span class="k">return</span> <span class="n">pred_classes</span><span class="p">,</span><span class="n">pred_boxs</span></div>

<div class="viewcode-block" id="smoke_get_n_classes"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.smoke_get_n_classes">[docs]</a><span class="k">def</span> <span class="nf">smoke_get_n_classes</span><span class="p">(</span><span class="n">predictions_list</span><span class="p">):</span>
    <span class="n">n_cars</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">n_bikes</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">n_pedestrians</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions_list</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
            <span class="n">n_cars</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mf">1.0</span><span class="p">:</span>
            <span class="n">n_bikes</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mf">2.0</span><span class="p">:</span>
            <span class="n">n_pedestrians</span><span class="o">+=</span><span class="mi">1</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">n_cars</span><span class="p">,</span><span class="n">n_pedestrians</span><span class="p">,</span><span class="n">n_bikes</span><span class="p">)</span></div>

<div class="viewcode-block" id="yolo_get_n_classes"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.yolo_get_n_classes">[docs]</a><span class="k">def</span> <span class="nf">yolo_get_n_classes</span><span class="p">(</span><span class="n">predictions_list</span><span class="p">):</span>
    <span class="n">n_cars</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">n_bikes</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">n_pedestrians</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions_list</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;car&#39;</span> <span class="ow">or</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;truck&#39;</span> <span class="ow">or</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;bus&#39;</span><span class="p">:</span>
            <span class="n">n_cars</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;bicycle&#39;</span> <span class="ow">or</span>  <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;motorbike&#39;</span> <span class="p">:</span>
            <span class="n">n_bikes</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">predictions_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;person&#39;</span><span class="p">:</span>
            <span class="n">n_pedestrians</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="n">n_detections</span><span class="o">=</span><span class="n">n_cars</span><span class="o">+</span><span class="n">n_bikes</span><span class="o">+</span><span class="n">n_pedestrians</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">n_detections</span><span class="p">,</span><span class="n">n_cars</span><span class="p">,</span><span class="n">n_pedestrians</span><span class="p">,</span><span class="n">n_bikes</span><span class="p">)</span></div>


<span class="c1"># # def precision(predictions,ground_truth):</span>
<span class="c1"># #     pass</span>

<span class="c1"># Python program to check if rectangles overlap</span>
<div class="viewcode-block" id="Point"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.Point">[docs]</a><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span></div>



 
<span class="c1"># Returns true if two rectangles(l1, r1)</span>
<span class="c1"># and (l2, r2) overlap</span>
<div class="viewcode-block" id="rectanges_overlap"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.rectanges_overlap">[docs]</a><span class="k">def</span> <span class="nf">rectanges_overlap</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">r2</span><span class="p">):</span>
    <span class="n">overlap_condition</span><span class="o">=</span><span class="kc">None</span>
    <span class="c1"># if rectangle has area 0, no overlap</span>
    <span class="k">if</span> <span class="n">l1</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">r1</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="n">l1</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">r1</span><span class="o">.</span><span class="n">y</span> <span class="ow">or</span> <span class="n">r2</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">l2</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="n">l2</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">r2</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
        <span class="c1">#print(&#39;False 1&#39;)</span>
        <span class="n">overlap_condition</span><span class="o">=</span><span class="mi">1</span>

        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="n">overlap_condition</span>
     
    <span class="c1"># If one rectangle is on left side of other</span>
    <span class="k">if</span> <span class="n">l1</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="n">l2</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
        <span class="c1">#print(&#39;False 2&#39;)</span>
        <span class="n">overlap_condition</span><span class="o">=</span><span class="mi">2</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="n">overlap_condition</span>
 
    <span class="c1"># If one rectangle is above other</span>
    <span class="k">if</span> <span class="n">r1</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">l2</span><span class="o">.</span><span class="n">y</span> <span class="ow">or</span> <span class="n">r2</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">l1</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
        <span class="c1"># print(&#39;L1.Y: &#39;,l1.y)</span>
        <span class="c1"># print(&#39;R2.Y: &#39;,r2.y)</span>

        <span class="c1"># print(&#39;L2.Y: &#39;,l2.y)</span>
        <span class="c1"># print(&#39;R1.Y: &#39;,r1.y)</span>
        <span class="n">overlap_condition</span><span class="o">=</span><span class="mi">3</span>

        <span class="c1">#print(&#39;False 3&#39;)</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="n">overlap_condition</span>
 
    <span class="c1">#print(&#39;rectangles overlap&#39;)</span>
    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span><span class="n">overlap_condition</span></div>

<div class="viewcode-block" id="boxes_in_list_do_not_intersect"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.boxes_in_list_do_not_intersect">[docs]</a><span class="k">def</span> <span class="nf">boxes_in_list_do_not_intersect</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">r2</span><span class="p">):</span>
    <span class="n">overlap_condition</span><span class="o">=</span><span class="kc">None</span>
     
    <span class="c1"># if rectangle has area 0, no overlap</span>
    <span class="k">if</span> <span class="n">l1</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">r1</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="n">l1</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">r1</span><span class="o">.</span><span class="n">y</span> <span class="ow">or</span> <span class="n">r2</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">l2</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="n">l2</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">r2</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
        <span class="c1">#print(&#39;False 1&#39;)</span>
        <span class="n">overlap_condition</span><span class="o">=</span><span class="mi">1</span>

        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="n">overlap_condition</span>
     
    <span class="c1"># If one rectangle is on left side of other</span>
    <span class="k">if</span> <span class="n">l1</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">r2</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="n">l2</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
        <span class="c1">#print(&#39;False 2&#39;)</span>
        <span class="n">overlap_condition</span><span class="o">=</span><span class="mi">2</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="n">overlap_condition</span>
 
    <span class="c1"># If one rectangle is above other</span>
    <span class="k">if</span> <span class="n">r1</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">l2</span><span class="o">.</span><span class="n">y</span> <span class="ow">or</span> <span class="n">r2</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">l1</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
        <span class="c1"># print(&#39;L1.Y: &#39;,l1.y)</span>
        <span class="c1"># print(&#39;R2.Y: &#39;,r2.y)</span>

        <span class="c1"># print(&#39;L2.Y: &#39;,l2.y)</span>
        <span class="c1"># print(&#39;R1.Y: &#39;,r1.y)</span>
        <span class="n">overlap_condition</span><span class="o">=</span><span class="mi">3</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False 3&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="n">overlap_condition</span>
 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rectangles pverlap&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span><span class="n">overlap_condition</span></div>


<div class="viewcode-block" id="get_IoU"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_IoU">[docs]</a><span class="k">def</span> <span class="nf">get_IoU</span><span class="p">(</span><span class="n">box1</span><span class="p">,</span><span class="n">box2</span><span class="p">):</span>

    <span class="c1"># box (Top Left X,Top Left Y,Bottom Right X,Bottom Right Y)</span>

    <span class="n">Pt1</span><span class="o">=</span><span class="n">box1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Pt2</span><span class="o">=</span><span class="n">box1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">Pt3</span><span class="o">=</span><span class="n">box2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Pt4</span><span class="o">=</span><span class="n">box2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


    <span class="c1"># l1=Point(x1,y1)</span>
    <span class="c1"># r1=Point(x2,y2)</span>

    <span class="c1"># l2=Point(x3,y3)</span>
    <span class="c1"># r2=Point(x4,y4)</span>


    <span class="c1">#print(&#39;IoU input in function: &#39;,(Pt1,Pt2,Pt3,Pt4))</span>
    <span class="n">boxs_overlap</span><span class="p">,</span><span class="n">overlap_condition</span><span class="o">=</span><span class="n">rectanges_overlap</span><span class="p">(</span><span class="n">Pt1</span><span class="p">,</span><span class="n">Pt2</span><span class="p">,</span><span class="n">Pt3</span><span class="p">,</span><span class="n">Pt4</span><span class="p">)</span>
    <span class="c1">#print(&#39;IoU boxs overlap in function: &#39;,boxs_overlap)</span>
    <span class="k">if</span> <span class="n">boxs_overlap</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>


        <span class="n">x_inter1</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">Pt1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">Pt3</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y_inter1</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">Pt1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">Pt3</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="n">x_inter2</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">Pt2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">Pt4</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y_inter2</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">Pt2</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">Pt4</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="c1"># print(&#39;(Y2,Y4): &#39;,(Pt2.y,Pt4.y))</span>

        <span class="c1"># print(&#39;Intersection Point 1: &#39;,(x_inter1,y_inter1))</span>
        <span class="c1"># print(&#39;Intersection Point 2: &#39;,(x_inter2,y_inter2))</span>

        <span class="n">width_inter</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">x_inter2</span><span class="o">-</span><span class="n">x_inter1</span><span class="p">)</span>
        <span class="n">height_inter</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">y_inter2</span><span class="o">-</span><span class="n">y_inter1</span><span class="p">)</span>

        <span class="n">area_inter</span><span class="o">=</span><span class="n">width_inter</span><span class="o">*</span><span class="n">height_inter</span>

        <span class="c1"># print(&#39;Width Intersection: &#39;,width_inter)</span>
        <span class="c1"># print(&#39;Height Intersection: &#39;,height_inter)</span>

        

        <span class="n">width_box1</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Pt2</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">Pt1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">height_box1</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Pt2</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">Pt1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="c1"># print(&#39;Width Box 1: &#39;,width_box1)</span>
        <span class="c1"># print(&#39;Height Box 1: &#39;,height_box1)</span>

        <span class="n">width_box2</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Pt4</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">Pt3</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">height_box2</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Pt4</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">Pt3</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="n">area_box1</span><span class="o">=</span><span class="n">width_box1</span><span class="o">*</span><span class="n">height_box1</span>
        <span class="n">area_box2</span><span class="o">=</span><span class="n">width_box2</span><span class="o">*</span><span class="n">height_box2</span>

        <span class="c1"># print(&#39;Area Box 1: &#39;,area_box1)</span>
        <span class="c1"># print(&#39;Area Box 2: &#39;,area_box2)</span>


        <span class="n">area_union</span><span class="o">=</span><span class="n">area_box1</span><span class="o">+</span><span class="n">area_box2</span><span class="o">-</span><span class="n">area_inter</span>

        <span class="c1"># print(&#39;Area Intersection: &#39;,area_inter)</span>
        <span class="c1"># print(&#39;Area Union: &#39;,area_union)</span>

        <span class="n">iou</span><span class="o">=</span><span class="n">area_inter</span><span class="o">/</span><span class="n">area_union</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># print(&#39;Rectangles Do not intersect&#39;)</span>
        <span class="n">iou</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="k">return</span> <span class="n">iou</span></div>

<div class="viewcode-block" id="get_key"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_key">[docs]</a><span class="k">def</span> <span class="nf">get_key</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">TYPE_ID_CONVERSION</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Car&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;Cyclist&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Pedestrian&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">TYPE_ID_CONVERSION</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span>
 
    <span class="k">return</span> <span class="s2">&quot;DontCare&quot;</span></div>


<div class="viewcode-block" id="get_evaluation_metrics"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_evaluation_metrics">[docs]</a><span class="k">def</span> <span class="nf">get_evaluation_metrics</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">,</span><span class="n">predictions</span><span class="p">):</span>
    <span class="n">TYPE_ID_CONVERSION</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Car&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;Cyclist&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Pedestrian&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">TP</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">)):</span>
        <span class="n">true_pt1</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">true_pt2</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]))</span>
        <span class="n">true_class</span><span class="o">=</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)):</span>

            <span class="n">pred_pt1</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="n">predictions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">pred_pt2</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span><span class="n">predictions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="n">pred_class_ID</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pred_class_string</span><span class="o">=</span><span class="n">get_key</span><span class="p">(</span><span class="n">pred_class_ID</span><span class="p">,</span><span class="n">TYPE_ID_CONVERSION</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred&#39;</span><span class="p">,(</span><span class="n">pred_pt1</span><span class="p">,</span><span class="n">pred_pt2</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Truth&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">true_pt1</span><span class="p">,</span><span class="n">true_pt2</span><span class="p">))</span>
            <span class="n">IoU</span><span class="o">=</span><span class="n">get_IoU</span><span class="p">((</span><span class="n">pred_pt1</span><span class="p">,</span><span class="n">pred_pt2</span><span class="p">),(</span><span class="n">true_pt1</span><span class="p">,</span><span class="n">true_pt2</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">true_class</span><span class="o">==</span><span class="s1">&#39;Car&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">IoU</span><span class="o">&gt;=</span><span class="mf">0.7</span> <span class="ow">and</span> <span class="n">pred_class_string</span><span class="o">==</span><span class="n">true_class</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True Positive Found&#39;</span><span class="p">)</span>
                    <span class="n">TP</span><span class="o">=</span><span class="n">TP</span><span class="o">+</span><span class="mi">1</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            
            <span class="k">elif</span> <span class="n">true_class</span><span class="o">==</span><span class="s1">&#39;Cyclist&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">IoU</span><span class="o">&gt;=</span><span class="mf">0.5</span> <span class="ow">and</span> <span class="n">pred_class_string</span><span class="o">==</span><span class="n">true_class</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True Positive Found&#39;</span><span class="p">)</span>
                    <span class="n">TP</span><span class="o">=</span><span class="n">TP</span><span class="o">+</span><span class="mi">1</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="n">true_class</span><span class="o">==</span><span class="s1">&#39;Pedestrian&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">IoU</span><span class="o">&gt;=</span><span class="mf">0.5</span> <span class="ow">and</span> <span class="n">pred_class_string</span><span class="o">==</span><span class="n">true_class</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True Positive Found&#39;</span><span class="p">)</span>
                    <span class="n">TP</span><span class="o">=</span><span class="n">TP</span><span class="o">+</span><span class="mi">1</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">return</span> <span class="n">TP</span></div>


<div class="viewcode-block" id="plot_groundtruth"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.plot_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">plot_groundtruth</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">groundtruth</span><span class="p">):</span>
    <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">groundtruth_img</span><span class="o">=</span><span class="n">img</span>
    <span class="n">gt_classes</span><span class="p">,</span><span class="n">gt_boxs</span><span class="o">=</span><span class="n">get_gt_classes_boxes</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">)</span>
    <span class="n">easy_indix_list</span><span class="o">=</span><span class="n">get_box_difficulty_index</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Easy&#39;</span><span class="p">)</span>
    <span class="n">moderate_indix_list</span><span class="o">=</span><span class="n">get_box_difficulty_index</span><span class="p">(</span><span class="n">gt_boxs</span><span class="p">,</span><span class="n">gt_classes</span><span class="p">,</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Moderate&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">)):</span>

        <span class="k">if</span> <span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Car&#39;</span><span class="ow">or</span> <span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Cyclist&#39;</span> <span class="ow">or</span> <span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Pedestrian&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Car&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">easy_indix_list</span><span class="p">:</span>
                    <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;DontCare&#39;</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>

        <span class="n">TL</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])),</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])))</span>
        <span class="n">BR</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">6</span><span class="p">])),</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">7</span><span class="p">])))</span>

        <span class="n">groundtruth_img</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">groundtruth_img</span><span class="p">,</span><span class="n">TL</span><span class="p">,</span><span class="n">BR</span><span class="p">,</span><span class="n">color</span><span class="p">,</span><span class="n">thickness</span><span class="p">)</span>

    
    <span class="k">return</span> <span class="n">groundtruth_img</span></div>

<div class="viewcode-block" id="plot_prediction"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.plot_prediction">[docs]</a><span class="k">def</span> <span class="nf">plot_prediction</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">predictions</span><span class="p">,</span><span class="n">color</span><span class="p">):</span>
    <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">prediction_img</span><span class="o">=</span><span class="n">img</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)):</span>

        <span class="c1">#color=(0,0,255)</span>
        <span class="n">TL</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])),</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])))</span>
        <span class="n">BR</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])),</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])))</span>

        <span class="n">prediction_img</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">prediction_img</span><span class="p">,</span><span class="n">TL</span><span class="p">,</span><span class="n">BR</span><span class="p">,</span><span class="n">color</span><span class="p">,</span><span class="n">thickness</span><span class="p">)</span>

    
    <span class="k">return</span> <span class="n">prediction_img</span></div>

<div class="viewcode-block" id="new_plot_prediction"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.new_plot_prediction">[docs]</a><span class="k">def</span> <span class="nf">new_plot_prediction</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">pred_objs</span><span class="p">,</span><span class="n">color</span><span class="p">):</span>
    <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">prediction_img</span><span class="o">=</span><span class="n">img</span>
    <span class="c1"># for pred_obj in pred_objs:</span>

    <span class="c1">#color=(0,0,255)</span>
    <span class="k">for</span> <span class="n">pred_obj</span> <span class="ow">in</span> <span class="n">pred_objs</span><span class="p">:</span>
        <span class="n">TL</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_obj</span><span class="o">.</span><span class="n">xmin</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_obj</span><span class="o">.</span><span class="n">ymin</span><span class="p">))</span>
        <span class="n">BR</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_obj</span><span class="o">.</span><span class="n">xmax</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">pred_obj</span><span class="o">.</span><span class="n">ymax</span><span class="p">))</span>

    <span class="n">prediction_img</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">prediction_img</span><span class="p">,</span><span class="n">TL</span><span class="p">,</span><span class="n">BR</span><span class="p">,</span><span class="n">color</span><span class="p">,</span><span class="n">thickness</span><span class="p">)</span>

    
    <span class="k">return</span> <span class="n">prediction_img</span></div>

<div class="viewcode-block" id="metrics_evaluator"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.metrics_evaluator">[docs]</a><span class="k">class</span> <span class="nc">metrics_evaluator</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_frames</span><span class="p">,</span><span class="n">results_path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Cyclist&#39;</span><span class="p">,</span><span class="s1">&#39;Pedestrian&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">difficulties</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Easy&#39;</span><span class="p">,</span><span class="s1">&#39;Moderate&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="p">[]</span><span class="c1">#np.zeros((n_frames ,len(self.difficulties)*len(self.labels)*3))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="o">=</span><span class="n">n_frames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gt_class_difficulty_count</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gt_class_total_count</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred_class_difficulty_count</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred_class_total_total_count</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>

        

<div class="viewcode-block" id="metrics_evaluator.get_boxs_classes_occlusion_truncation"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.metrics_evaluator.get_boxs_classes_occlusion_truncation">[docs]</a>    <span class="k">def</span> <span class="nf">get_boxs_classes_occlusion_truncation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">groundtruth</span><span class="p">,</span><span class="n">smoke_predictions_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gt_classes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_boxs</span><span class="o">=</span><span class="n">get_gt_classes_boxes</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred_classes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pred_boxs</span><span class="o">=</span><span class="n">get_pred_classes_boxes</span><span class="p">(</span><span class="n">smoke_predictions_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gt_truncation</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_occlusion</span><span class="o">=</span><span class="n">get_gt_truncation_occlusion</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">)</span></div>

<div class="viewcode-block" id="metrics_evaluator.get_metrics"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.metrics_evaluator.get_metrics">[docs]</a>    <span class="k">def</span> <span class="nf">get_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data_row</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">gt_class_difficulty_count_row</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">gt_class_total_count_per_frame</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">pred_class_difficulty_count</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">pred_class_total_count_per_frame</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">gt_class_total_count_per_frame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_classes</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
            <span class="n">pred_class_total_count_per_frame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pred_classes</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gt_class_total_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt_class_total_count_per_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred_class_total_total_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_class_total_count_per_frame</span><span class="p">)</span>



        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">difficulty</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulties</span><span class="p">:</span>
                <span class="n">class_gt_instances</span><span class="p">,</span><span class="n">class_pred_instances</span><span class="p">,</span><span class="n">TP</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">FN</span><span class="o">=</span><span class="n">get_metrics_label_specific_2</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">difficulty</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_classes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pred_classes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_boxs</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pred_boxs</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_truncation</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_occlusion</span><span class="p">)</span>
                <span class="n">data_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">TP</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">FN</span><span class="p">])</span>
                <span class="n">gt_class_difficulty_count_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_gt_instances</span><span class="p">)</span>
                <span class="n">pred_class_difficulty_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_pred_instances</span><span class="p">)</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_row</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gt_class_difficulty_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt_class_difficulty_count_row</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred_class_difficulty_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_class_difficulty_count</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="o">+=</span><span class="mi">1</span></div>

<div class="viewcode-block" id="metrics_evaluator.tabularize"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.metrics_evaluator.tabularize">[docs]</a>    <span class="k">def</span> <span class="nf">tabularize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data Array Size&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">tabularize_metrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_class_total_count</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gt_class_difficulty_count</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pred_class_total_total_count</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pred_class_difficulty_count</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="metrics_evaluator.evaluate_metrics"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.metrics_evaluator.evaluate_metrics">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">groundtruth</span><span class="p">,</span><span class="n">smoke_predictions_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_boxs_classes_occlusion_truncation</span><span class="p">(</span><span class="n">groundtruth</span><span class="p">,</span><span class="n">smoke_predictions_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_metrics</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabularize</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="yolo_2_smoke_output_format"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.yolo_2_smoke_output_format">[docs]</a><span class="k">def</span> <span class="nf">yolo_2_smoke_output_format</span><span class="p">(</span><span class="n">boxs</span><span class="p">,</span><span class="n">classes</span><span class="p">,</span><span class="n">scores</span><span class="p">):</span>

    <span class="n">output_per_frame</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">box</span><span class="p">,</span><span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span><span class="n">boxs</span><span class="p">,</span><span class="n">scores</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;car&#39;</span> <span class="ow">or</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;truck&#39;</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">elif</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;bicycle&#39;</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=</span><span class="mi">1</span>

        <span class="k">elif</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;person&#39;</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=</span><span class="mi">2</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=-</span><span class="mi">1</span>

        <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">=</span><span class="n">yolobbox2bbox</span><span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>


        <span class="n">output_per_frame</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">class_id</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="n">score</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">output_per_frame</span></div>

<div class="viewcode-block" id="yolo_2_json_output_format"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.yolo_2_json_output_format">[docs]</a><span class="k">def</span> <span class="nf">yolo_2_json_output_format</span><span class="p">(</span><span class="n">boxs</span><span class="p">,</span><span class="n">classes</span><span class="p">,</span><span class="n">scores</span><span class="p">):</span>

    <span class="n">output_per_frame</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">box</span><span class="p">,</span><span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span><span class="n">boxs</span><span class="p">,</span><span class="n">scores</span><span class="p">):</span>


        <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">=</span><span class="n">yolobbox2bbox</span><span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>


        <span class="n">output_per_frame</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">label</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="n">score</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">output_per_frame</span></div>


<div class="viewcode-block" id="modified_yolo_2_smoke_output_format"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.modified_yolo_2_smoke_output_format">[docs]</a><span class="k">def</span> <span class="nf">modified_yolo_2_smoke_output_format</span><span class="p">(</span><span class="n">boxs</span><span class="p">,</span><span class="n">classes</span><span class="p">):</span>

    <span class="n">output_per_frame</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">box</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span><span class="n">boxs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;car&#39;</span> <span class="ow">or</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;truck&#39;</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">elif</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;bicycle&#39;</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=</span><span class="mi">1</span>

        <span class="k">elif</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;person&#39;</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=</span><span class="mi">2</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">class_id</span><span class="o">=-</span><span class="mi">1</span>

        <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">=</span><span class="n">yolobbox2bbox</span><span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">box</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>


        <span class="n">output_per_frame</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">class_id</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">output_per_frame</span></div>

    

<div class="viewcode-block" id="yolobbox2bbox"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.yolobbox2bbox">[docs]</a><span class="k">def</span> <span class="nf">yolobbox2bbox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span>
    <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span></div>


<div class="viewcode-block" id="convert_prediction_text_format"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.convert_prediction_text_format">[docs]</a><span class="k">def</span> <span class="nf">convert_prediction_text_format</span><span class="p">(</span><span class="n">prediction</span><span class="p">):</span>
    <span class="n">class_in_text_format</span><span class="o">=</span><span class="n">get_key</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">class_in_text_format</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
                <span class="p">]</span>
    <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="convert_prediction_json_format"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.convert_prediction_json_format">[docs]</a><span class="k">def</span> <span class="nf">convert_prediction_json_format</span><span class="p">(</span><span class="n">prediction</span><span class="p">):</span>
    <span class="c1">#class_in_text_format=get_key(int(prediction[0]))</span>

    <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span>
                <span class="n">prediction</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
                <span class="p">]</span>
    <span class="k">return</span> <span class="n">data</span></div>




<div class="viewcode-block" id="read_prediction"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.read_prediction">[docs]</a><span class="k">def</span> <span class="nf">read_prediction</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="n">fileid</span><span class="p">):</span>

    <span class="n">TYPE_ID_CONVERSION</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;Car&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s1">&#39;Cyclist&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s1">&#39;Pedestrian&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                        <span class="s1">&#39;DontCare&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
                        <span class="p">}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">rows</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;predictions_folder: &quot;</span><span class="p">,</span><span class="n">predictions_folder_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fileid: &quot;</span><span class="p">,</span><span class="n">fileid</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rows: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">rows</span><span class="p">)</span>
    <span class="c1"># for row in rows:</span>
    <span class="c1">#     print(&quot;type(row[0]): &quot;,type(row[0]))</span>
    <span class="c1">#     print(&quot;row[0]: &quot;,row[0])</span>
        <span class="c1"># print(&#39;row[0]: &#39;,row[0])</span>
        <span class="c1"># print(&#39;row: &#39;,row[0].split(&#39; &#39;))</span>

    <span class="c1"># predictions=[[float(row[0].split(&#39; &#39;))]]</span>

    <span class="c1"># smoke_predictions_read_from_file=[[float(row[0].split(&#39; &#39;)[i])  if i!=0 else TYPE_ID_CONVERSION[row[0].split(&#39; &#39;)[i] ] for i in [0]+list(range(3,len(row[0].split(&#39; &#39;))))] for row in rows]</span>

    <span class="n">smoke_predictions_read_from_file</span><span class="o">=</span><span class="p">[[</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="n">i</span><span class="p">])</span>  <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span> <span class="k">else</span> <span class="n">TYPE_ID_CONVERSION</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span> <span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))))]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#smoke_predictions_read_from_file=[[float(row[0].split(&#39; &#39;)[i])  if i!=0 else TYPE_ID_CONVERSION[row[0].split(&#39; &#39;)[i] ] for i in [0]+list(range(3,len(row[0].split(&#39; &#39;))))] for row in rows]</span>

    <span class="k">return</span> <span class="n">smoke_predictions_read_from_file</span></div>


<div class="viewcode-block" id="write_prediction"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.write_prediction">[docs]</a><span class="k">def</span> <span class="nf">write_prediction</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="n">fileid</span><span class="p">,</span><span class="n">predictions_list</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

        
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions_list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prediction: &#39;</span><span class="p">,</span><span class="n">prediction</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Items in Prediction: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">convert_prediction_text_format</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>

    <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="new_write_prediction"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.new_write_prediction">[docs]</a><span class="k">def</span> <span class="nf">new_write_prediction</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="n">fileid</span><span class="p">,</span><span class="n">pred_objs</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">pred_obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pred_objs</span><span class="p">):</span>
            <span class="c1"># print(&#39;Prediction: &#39;,prediction)</span>
            <span class="c1"># print(&#39;Items in Prediction: &#39;,len(prediction))</span>
            
            <span class="n">pred_obj</span><span class="o">.</span><span class="n">get_preds_string</span><span class="p">()</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">pred_obj</span><span class="o">.</span><span class="n">preds_list_string</span><span class="p">])</span>

    <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="write_json"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.write_json">[docs]</a><span class="k">def</span> <span class="nf">write_json</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="n">fileid</span><span class="p">,</span><span class="n">predictions_list</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predictions_folder_path</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">lineterminator</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions_list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prediction: &#39;</span><span class="p">,</span><span class="n">prediction</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Items in Prediction: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">convert_prediction_json_format</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>

    <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="get_class_AP"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_class_AP">[docs]</a><span class="k">def</span> <span class="nf">get_class_AP</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span><span class="n">label</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;Car&#39;</span><span class="p">:</span>
        <span class="n">AP_file</span><span class="o">=</span><span class="s1">&#39;plot/car_detection.txt&#39;</span>

    <span class="k">elif</span> <span class="n">label</span><span class="o">==</span><span class="s1">&#39;Pedestrian&#39;</span><span class="p">:</span>
        <span class="n">AP_file</span><span class="o">=</span><span class="s1">&#39;plot/pedestrian_detection.txt&#39;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span><span class="n">AP_file</span><span class="p">),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">reader</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">data</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>


        <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="n">column1</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">column2</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">column3</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">column4</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="n">class_easy_AP</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">column2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">40</span>
        <span class="n">class_moderate_AP</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">column3</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">40</span>
        <span class="n">class_hard_AP</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">column4</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">40</span>
    
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No </span><span class="si">{}</span><span class="s1">s Detected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="n">class_easy_AP</span><span class="o">=</span><span class="mi">0</span><span class="c1">#100*sum(column2[1:])/40</span>
        <span class="n">class_moderate_AP</span><span class="o">=</span><span class="mi">0</span><span class="c1">#100*sum(column3[1:])/40</span>
        <span class="n">class_hard_AP</span><span class="o">=</span><span class="mi">0</span><span class="c1">#100*sum(column4[1:])/40</span>


    <span class="k">return</span> <span class="n">class_easy_AP</span><span class="p">,</span><span class="n">class_moderate_AP</span><span class="p">,</span><span class="n">class_hard_AP</span></div>



<div class="viewcode-block" id="construct_dataframe"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.construct_dataframe">[docs]</a><span class="k">def</span> <span class="nf">construct_dataframe</span><span class="p">(</span><span class="n">cars_AP</span><span class="p">,</span><span class="n">pedestrians_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">,</span><span class="n">n_objects_classes</span><span class="p">,</span><span class="n">n_objects_difficulties</span><span class="p">):</span>

    <span class="n">cars_easy_AP</span><span class="p">,</span><span class="n">cars_moderate_AP</span><span class="p">,</span><span class="n">cars_hard_AP</span><span class="o">=</span><span class="n">cars_AP</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">cars_AP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">cars_AP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">pedestrian_easy_AP</span><span class="p">,</span><span class="n">pedestrian_moderate_AP</span><span class="p">,</span><span class="n">pedestrian_hard_AP</span><span class="o">=</span><span class="n">pedestrians_AP</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pedestrians_AP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">pedestrians_AP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># easy_car_metrics=</span>
    <span class="c1"># moderate_car_metrics=</span>
    <span class="c1"># hard_car_metrics=</span>


    <span class="c1"># easy_cars=&#39;AP: {} - Precision: {} - Recall: {}      &#39;.format(cars_easy_AP,car_metrics[0],car_metrics[0])</span>
    <span class="c1"># moderate_cars=&#39;AP: {} - Precision: {} - Recall: {}      &#39;.format(cars_easy_AP,car_metrics[2],car_metrics[3])</span>
    <span class="c1"># hard_cars=&#39;AP: {} - Precision: {} - Recall: {}      &#39;.format(cars_hard_AP,car_metrics[4],car_metrics[5])</span>
    <span class="c1"># overall_cars=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># cars=[easy_cars,moderate_cars,hard_cars,overall_cars]</span>


    <span class="c1"># easy_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(pedestrian_easy_AP,pedestrian_metrics[0],pedestrian_metrics[1])</span>
    <span class="c1"># moderate_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(pedestrian_easy_AP,pedestrian_metrics[2],pedestrian_metrics[3])</span>
    <span class="c1"># hard_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(pedestrian_hard_AP,pedestrian_metrics[4],pedestrian_metrics[5])</span>
    <span class="c1"># overall_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}        &#39;.format(0,0,0)</span>
    <span class="c1"># pedestrians=[easy_pedestrians,moderate_pedestrians,hard_pedestrians,overall_pedestrians]</span>

    <span class="c1"># easy_classes=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># moderate_classes=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># hard_classes=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># overall_classes=&#39;AP: {} - Precision: {} - Recall: {}        &#39;.format(0,0,0)</span>

    <span class="k">if</span> <span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">ratio_easy_cars_to_total_cars</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ratio_moderate_cars_to_total_cars</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ratio_hard_cars_to_total_cars</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        

    <span class="k">else</span><span class="p">:</span>

        <span class="n">ratio_easy_cars_to_total_cars</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_moderate_cars_to_total_cars</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_hard_cars_to_total_cars</span><span class="o">=</span><span class="mi">0</span>


    <span class="k">if</span> <span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ratio_easy_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">ratio_moderate_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">ratio_hard_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_easy_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_moderate_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_hard_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="mi">0</span>



    <span class="n">overall_cars_AP</span><span class="o">=</span><span class="p">(</span><span class="n">cars_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_cars_to_total_cars</span><span class="p">)</span> <span class="o">+</span><span class="p">(</span><span class="n">cars_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_cars_to_total_cars</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">cars_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_cars_to_total_cars</span><span class="p">)</span>
    <span class="n">overall_predestrians_AP</span><span class="o">=</span><span class="p">(</span><span class="n">pedestrian_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_pedestrians_to_total_pedestrians</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">pedestrian_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_pedestrians_to_total_pedestrians</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">pedestrian_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_pedestrians_to_total_pedestrians</span><span class="p">)</span>

    <span class="n">easy_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cars_easy_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">moderate_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cars_moderate_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">hard_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cars_hard_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">overall_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">overall_cars_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">cars</span><span class="o">=</span><span class="p">[</span><span class="n">easy_cars</span><span class="p">,</span><span class="n">moderate_cars</span><span class="p">,</span><span class="n">hard_cars</span><span class="p">,</span><span class="n">overall_cars</span><span class="p">,</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>


    <span class="n">easy_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pedestrian_easy_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">moderate_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pedestrian_moderate_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">hard_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pedestrian_hard_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">overall_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">overall_predestrians_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">pedestrians</span><span class="o">=</span><span class="p">[</span><span class="n">easy_pedestrians</span><span class="p">,</span><span class="n">moderate_pedestrians</span><span class="p">,</span><span class="n">hard_pedestrians</span><span class="p">,</span><span class="n">overall_pedestrians</span><span class="p">,</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span>


    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>


        <span class="n">ratio_easy_cars_to_easy_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ratio_easy_pedestrians_to_easy_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_easy_cars_to_easy_objects</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_easy_pedestrians_to_easy_objects</span><span class="o">=</span><span class="mi">0</span>

    

    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>


        <span class="n">ratio_moderate_cars_to_moderate_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ratio_moderate_pedestrians_to_moderate_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_moderate_cars_to_moderate_objects</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_moderate_pedestrians_to_moderate_objects</span><span class="o">=</span><span class="mi">0</span>

    

    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">ratio_hard_cars_to_hard_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ratio_hard_pedestrians_to_hard_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_hard_cars_to_hard_objects</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_hard_pedestrians_to_hard_objects</span><span class="o">=</span><span class="mi">0</span>

    <span class="n">AP_weighted_average_easy</span><span class="o">=</span><span class="p">(</span><span class="n">cars_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_cars_to_easy_objects</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_pedestrians_to_easy_objects</span><span class="p">)</span>
    <span class="n">AP_weighted_average_moderate</span><span class="o">=</span><span class="p">(</span><span class="n">cars_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_cars_to_moderate_objects</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_pedestrians_to_moderate_objects</span><span class="p">)</span>
    <span class="n">AP_weighted_average_hard</span><span class="o">=</span><span class="p">(</span><span class="n">cars_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_cars_to_hard_objects</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_pedestrians_to_hard_objects</span><span class="p">)</span>

    <span class="n">easy_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AP_weighted_average_easy</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">moderate_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AP_weighted_average_moderate</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">hard_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AP_weighted_average_hard</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>


    <span class="n">ratio_cars_to_total_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ratio_pedestrians_to_total_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">overall_precision</span><span class="o">=</span><span class="p">(</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_cars_to_total_objects</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_pedestrians_to_total_objects</span><span class="p">)</span>
    <span class="n">overall_recall</span><span class="o">=</span><span class="p">(</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_cars_to_total_objects</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_pedestrians_to_total_objects</span><span class="p">)</span>
    <span class="n">overall_AP</span><span class="o">=</span><span class="p">(</span><span class="n">overall_cars_AP</span><span class="o">*</span><span class="n">ratio_cars_to_total_objects</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">overall_predestrians_AP</span><span class="o">*</span><span class="n">ratio_pedestrians_to_total_objects</span><span class="p">)</span>





    <span class="n">overall_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">overall_AP</span><span class="p">,</span><span class="n">overall_precision</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">overall_recall</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="n">easy_classes</span><span class="p">,</span><span class="n">moderate_classes</span><span class="p">,</span><span class="n">hard_classes</span><span class="p">,</span><span class="n">overall_classes</span><span class="p">,(</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>

    <span class="n">column_headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class/Difficulty&#39;</span><span class="p">,</span><span class="s1">&#39;Easy&#39;</span><span class="p">,</span><span class="s1">&#39;Moderate&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">,</span><span class="s1">&#39;Overall Difficulties&#39;</span><span class="p">,</span><span class="s1">&#39;Class # Objects&#39;</span><span class="p">]</span>
    <span class="n">row_headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Pedestrian&#39;</span><span class="p">,</span><span class="s1">&#39;Cars and Pedestrians&#39;</span><span class="p">,</span><span class="s1">&#39;Difficulty # Objects&#39;</span><span class="p">]</span>

    <span class="c1"># data=np.zeros((3,4))</span>

    <span class="n">ar1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cars</span><span class="p">)</span>
    <span class="n">ar2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pedestrians</span><span class="p">)</span>
    <span class="n">ar3</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
    <span class="n">ar4</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;Ø&#39;</span><span class="p">])</span>

    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">ar1</span><span class="p">,</span><span class="n">ar2</span><span class="p">,</span><span class="n">ar3</span><span class="p">,</span><span class="n">ar4</span><span class="p">))</span>

    <span class="n">ARRAY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">row_headers</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>

    <span class="n">ARRAY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">column_headers</span><span class="p">,</span><span class="n">ARRAY</span><span class="p">))</span>

    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.colheader_justify&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;colheader_justify&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ARRAY</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1"># dfStyler = df.style.set_properties(**{&#39;text-align&#39;: &#39;center&#39;})</span>
    <span class="c1"># dfStyler.set_table_styles([dict(selector=&#39;th&#39;, props=[(&#39;text-align&#39;, &#39;center&#39;)])])</span>
    <span class="c1"># [dict(selector=&#39;th&#39;, props=[(&#39;text-align&#39;, &#39;center&#39;)])]</span>
    
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border&quot;</span><span class="p">,</span> <span class="s2">&quot;1px solid&quot;</span><span class="p">)]},</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;tbody td&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border&quot;</span><span class="p">,</span> <span class="s2">&quot;1px solid&quot;</span><span class="p">)]},</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;th&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border&quot;</span><span class="p">,</span> <span class="s2">&quot;1px solid&quot;</span><span class="p">)]},</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;th&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;text-align&quot;</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">)]},</span>
        <span class="p">])</span>
    <span class="n">df1</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Object Detector Metrics Evaluation [Average Precision - Precision - Recall ]&#39;</span><span class="p">)</span>
    <span class="n">df1</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
    <span class="c1">#df1.style.set_table_attributes(&quot;style=&#39;display:inline&#39;&quot;).set_caption(&#39;Caption table&#39;)</span>

    <span class="c1"># df2=df1.style.set_table_styles(</span>
    <span class="c1">#     [{&quot;selector&quot;: &quot;&quot;, &quot;props&quot;: [(&quot;border&quot;, &quot;1px solid&quot;)]},</span>
    <span class="c1">#       {&quot;selector&quot;: &quot;tbody td&quot;, &quot;props&quot;: [(&quot;border&quot;, &quot;1px solid&quot;)]},</span>
    <span class="c1">#      {&quot;selector&quot;: &quot;th&quot;, &quot;props&quot;: [(&quot;border&quot;, &quot;1px solid&quot;)]}])</span>


   
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>


    <span class="c1"># AP - Precision - Recall</span>

    <span class="n">metrics_results</span><span class="o">=</span><span class="p">{</span>
              <span class="s1">&#39;Easy Cars&#39;</span><span class="p">:[</span><span class="n">cars_easy_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Moderate Cars&#39;</span><span class="p">:[</span><span class="n">cars_moderate_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Hard Cars&#39;</span><span class="p">:[</span><span class="n">cars_hard_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Overall Cars&#39;</span><span class="p">:[</span><span class="n">overall_cars_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Pedestrians Easy&#39;</span><span class="p">:[</span><span class="n">pedestrian_easy_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Pedestrians Moderate&#39;</span><span class="p">:[</span><span class="n">pedestrian_moderate_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Pedestrians Hard&#39;</span><span class="p">:[</span><span class="n">pedestrian_hard_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Overall Pedestrians&#39;</span><span class="p">:[</span><span class="n">overall_predestrians_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Overall Easy&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">AP_weighted_average_easy</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Overall Moderate&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">AP_weighted_average_moderate</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Overall Hard&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">AP_weighted_average_hard</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Overall Overall&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">overall_AP</span><span class="p">,</span><span class="n">overall_precision</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">overall_recall</span><span class="o">*</span><span class="mi">100</span><span class="p">]</span>

            <span class="p">}</span>

    <span class="n">bar_metrics</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics_results</span><span class="p">)</span>

    <span class="c1"># bar_metrics.plot(kind=&#39;bar&#39;,title=&quot;SMOKE Evaluation Results&quot;)</span>

    <span class="c1"># plt.xlabel(&quot;Difficulties&quot;)</span>
    <span class="c1"># plt.ylabel(&quot;Percentage %&quot;)</span>
    <span class="c1"># plt.xticks(ticks=[0,1,2],labels=[&#39;AP&#39;,&#39;Precision&#39;,&#39;Recall&#39;])</span>



    <span class="k">return</span> <span class="n">df1</span><span class="p">,</span><span class="n">bar_metrics</span></div>



<div class="viewcode-block" id="construct_dataframe_v2"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.construct_dataframe_v2">[docs]</a><span class="k">def</span> <span class="nf">construct_dataframe_v2</span><span class="p">(</span><span class="n">object_detector</span><span class="p">,</span><span class="n">cars_AP</span><span class="p">,</span><span class="n">pedestrians_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">,</span><span class="n">n_objects_classes</span><span class="p">,</span><span class="n">n_objects_difficulties</span><span class="p">):</span>



    <span class="c1"># easy_car_metrics=</span>
    <span class="c1"># moderate_car_metrics=</span>
    <span class="c1"># hard_car_metrics=</span>


    <span class="c1"># easy_cars=&#39;AP: {} - Precision: {} - Recall: {}      &#39;.format(cars_easy_AP,car_metrics[0],car_metrics[0])</span>
    <span class="c1"># moderate_cars=&#39;AP: {} - Precision: {} - Recall: {}      &#39;.format(cars_easy_AP,car_metrics[2],car_metrics[3])</span>
    <span class="c1"># hard_cars=&#39;AP: {} - Precision: {} - Recall: {}      &#39;.format(cars_hard_AP,car_metrics[4],car_metrics[5])</span>
    <span class="c1"># overall_cars=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># cars=[easy_cars,moderate_cars,hard_cars,overall_cars]</span>


    <span class="c1"># easy_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(pedestrian_easy_AP,pedestrian_metrics[0],pedestrian_metrics[1])</span>
    <span class="c1"># moderate_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(pedestrian_easy_AP,pedestrian_metrics[2],pedestrian_metrics[3])</span>
    <span class="c1"># hard_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(pedestrian_hard_AP,pedestrian_metrics[4],pedestrian_metrics[5])</span>
    <span class="c1"># overall_pedestrians=&#39;AP: {} - Precision: {} - Recall: {}        &#39;.format(0,0,0)</span>
    <span class="c1"># pedestrians=[easy_pedestrians,moderate_pedestrians,hard_pedestrians,overall_pedestrians]</span>

    <span class="c1"># easy_classes=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># moderate_classes=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># hard_classes=&#39;AP: {} - Precision: {} - Recall: {}       &#39;.format(0,0,0)</span>
    <span class="c1"># overall_classes=&#39;AP: {} - Precision: {} - Recall: {}        &#39;.format(0,0,0)</span>

    <span class="c1"># Fix According to n objects (currently quick fix)</span>
    <span class="k">if</span> <span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">ratio_easy_cars_to_total_cars</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ratio_moderate_cars_to_total_cars</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ratio_hard_cars_to_total_cars</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1">#if n_objects_difficulties[0]==</span>
        <span class="n">easy_cars_AP</span><span class="o">=</span><span class="n">cars_AP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">moderate_cars_AP</span><span class="o">=</span><span class="n">cars_AP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">hard_cars_AP</span><span class="o">=</span><span class="n">cars_AP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        

    <span class="k">else</span><span class="p">:</span>

        <span class="n">ratio_easy_cars_to_total_cars</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_moderate_cars_to_total_cars</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_hard_cars_to_total_cars</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">easy_cars_AP</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">moderate_cars_AP</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">hard_cars_AP</span><span class="o">=</span><span class="mi">0</span>






    <span class="k">if</span> <span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ratio_easy_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">ratio_moderate_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">ratio_hard_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        
        <span class="n">easy_pedestrians_AP</span><span class="o">=</span><span class="n">pedestrians_AP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">moderate_pedestrians_AP</span><span class="o">=</span><span class="n">pedestrians_AP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">hard_pedestrians_AP</span><span class="o">=</span><span class="n">pedestrians_AP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>


    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_easy_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_moderate_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_hard_pedestrians_to_total_pedestrians</span><span class="o">=</span><span class="mi">0</span>

        <span class="n">easy_pedestrians_AP</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">moderate_pedestrians_AP</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">hard_pedestrians_AP</span><span class="o">=</span><span class="mi">0</span>


    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">easy_cars_AP</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">easy_pedestrians_AP</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">moderate_cars_AP</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">moderate_pedestrians_AP</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">hard_cars_AP</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">hard_pedestrians_AP</span><span class="o">=</span><span class="mi">0</span>


    <span class="n">cars_easy_AP</span><span class="p">,</span><span class="n">cars_moderate_AP</span><span class="p">,</span><span class="n">cars_hard_AP</span><span class="o">=</span><span class="n">easy_cars_AP</span><span class="p">,</span><span class="n">moderate_cars_AP</span><span class="p">,</span><span class="n">hard_cars_AP</span>
    <span class="n">pedestrian_easy_AP</span><span class="p">,</span><span class="n">pedestrian_moderate_AP</span><span class="p">,</span><span class="n">pedestrian_hard_AP</span><span class="o">=</span><span class="n">easy_pedestrians_AP</span><span class="p">,</span><span class="n">moderate_pedestrians_AP</span><span class="p">,</span><span class="n">hard_pedestrians_AP</span>


    <span class="n">overall_cars_AP</span><span class="o">=</span><span class="p">(</span><span class="n">cars_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_cars_to_total_cars</span><span class="p">)</span> <span class="o">+</span><span class="p">(</span><span class="n">cars_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_cars_to_total_cars</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">cars_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_cars_to_total_cars</span><span class="p">)</span>
    <span class="n">overall_predestrians_AP</span><span class="o">=</span><span class="p">(</span><span class="n">pedestrian_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_pedestrians_to_total_pedestrians</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">pedestrian_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_pedestrians_to_total_pedestrians</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">pedestrian_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_pedestrians_to_total_pedestrians</span><span class="p">)</span>

    <span class="n">easy_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cars_easy_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">moderate_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cars_moderate_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">hard_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cars_hard_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">overall_cars</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">overall_cars_AP</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">cars</span><span class="o">=</span><span class="p">[</span><span class="n">easy_cars</span><span class="p">,</span><span class="n">moderate_cars</span><span class="p">,</span><span class="n">hard_cars</span><span class="p">,</span><span class="n">overall_cars</span><span class="p">,</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>


    <span class="n">easy_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pedestrian_easy_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">moderate_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pedestrian_moderate_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">hard_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pedestrian_hard_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">overall_pedestrians</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">overall_predestrians_AP</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">pedestrians</span><span class="o">=</span><span class="p">[</span><span class="n">easy_pedestrians</span><span class="p">,</span><span class="n">moderate_pedestrians</span><span class="p">,</span><span class="n">hard_pedestrians</span><span class="p">,</span><span class="n">overall_pedestrians</span><span class="p">,</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span>


    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>


        <span class="n">ratio_easy_cars_to_easy_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ratio_easy_pedestrians_to_easy_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_easy_cars_to_easy_objects</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_easy_pedestrians_to_easy_objects</span><span class="o">=</span><span class="mi">0</span>

    

    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>


        <span class="n">ratio_moderate_cars_to_moderate_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ratio_moderate_pedestrians_to_moderate_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_moderate_cars_to_moderate_objects</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_moderate_pedestrians_to_moderate_objects</span><span class="o">=</span><span class="mi">0</span>

    

    <span class="k">if</span> <span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">ratio_hard_cars_to_hard_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ratio_hard_pedestrians_to_hard_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">/</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ratio_hard_cars_to_hard_objects</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">ratio_hard_pedestrians_to_hard_objects</span><span class="o">=</span><span class="mi">0</span>

    <span class="n">AP_weighted_average_easy</span><span class="o">=</span><span class="p">(</span><span class="n">cars_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_cars_to_easy_objects</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_easy_AP</span><span class="o">*</span><span class="n">ratio_easy_pedestrians_to_easy_objects</span><span class="p">)</span>
    <span class="n">AP_weighted_average_moderate</span><span class="o">=</span><span class="p">(</span><span class="n">cars_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_cars_to_moderate_objects</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_moderate_AP</span><span class="o">*</span><span class="n">ratio_moderate_pedestrians_to_moderate_objects</span><span class="p">)</span>
    <span class="n">AP_weighted_average_hard</span><span class="o">=</span><span class="p">(</span><span class="n">cars_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_cars_to_hard_objects</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_hard_AP</span><span class="o">*</span><span class="n">ratio_hard_pedestrians_to_hard_objects</span><span class="p">)</span>

    <span class="n">easy_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AP_weighted_average_easy</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">moderate_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AP_weighted_average_moderate</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">hard_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AP_weighted_average_hard</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>


    <span class="n">ratio_cars_to_total_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ratio_pedestrians_to_total_objects</span><span class="o">=</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">overall_precision</span><span class="o">=</span><span class="p">(</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_cars_to_total_objects</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_pedestrians_to_total_objects</span><span class="p">)</span>
    <span class="n">overall_recall</span><span class="o">=</span><span class="p">(</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_cars_to_total_objects</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">ratio_pedestrians_to_total_objects</span><span class="p">)</span>
    <span class="n">overall_AP</span><span class="o">=</span><span class="p">(</span><span class="n">overall_cars_AP</span><span class="o">*</span><span class="n">ratio_cars_to_total_objects</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">overall_predestrians_AP</span><span class="o">*</span><span class="n">ratio_pedestrians_to_total_objects</span><span class="p">)</span>





    <span class="n">overall_classes</span><span class="o">=</span><span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> - </span><span class="si">{:.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">overall_AP</span><span class="p">,</span><span class="n">overall_precision</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">overall_recall</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="n">easy_classes</span><span class="p">,</span><span class="n">moderate_classes</span><span class="p">,</span><span class="n">hard_classes</span><span class="p">,</span><span class="n">overall_classes</span><span class="p">,(</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">n_objects_classes</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>

    <span class="n">column_headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class/Difficulty&#39;</span><span class="p">,</span><span class="s1">&#39;Easy&#39;</span><span class="p">,</span><span class="s1">&#39;Moderate&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">,</span><span class="s1">&#39;Overall Difficulties&#39;</span><span class="p">,</span><span class="s1">&#39;Class # Objects&#39;</span><span class="p">]</span>
    <span class="n">row_headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Pedestrian&#39;</span><span class="p">,</span><span class="s1">&#39;Cars and Pedestrians&#39;</span><span class="p">,</span><span class="s1">&#39;Difficulty # Objects&#39;</span><span class="p">]</span>

    <span class="c1"># data=np.zeros((3,4))</span>

    <span class="n">ar1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cars</span><span class="p">)</span>
    <span class="n">ar2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pedestrians</span><span class="p">)</span>
    <span class="n">ar3</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
    <span class="n">ar4</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">n_objects_difficulties</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;Ø&#39;</span><span class="p">])</span>

    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">ar1</span><span class="p">,</span><span class="n">ar2</span><span class="p">,</span><span class="n">ar3</span><span class="p">,</span><span class="n">ar4</span><span class="p">))</span>

    <span class="n">ARRAY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">row_headers</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>

    <span class="n">ARRAY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">column_headers</span><span class="p">,</span><span class="n">ARRAY</span><span class="p">))</span>

    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.colheader_justify&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;colheader_justify&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ARRAY</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1"># dfStyler = df.style.set_properties(**{&#39;text-align&#39;: &#39;center&#39;})</span>
    <span class="c1"># dfStyler.set_table_styles([dict(selector=&#39;th&#39;, props=[(&#39;text-align&#39;, &#39;center&#39;)])])</span>
    <span class="c1"># [dict(selector=&#39;th&#39;, props=[(&#39;text-align&#39;, &#39;center&#39;)])]</span>
    
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border&quot;</span><span class="p">,</span> <span class="s2">&quot;1px solid&quot;</span><span class="p">)]},</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;tbody td&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border&quot;</span><span class="p">,</span> <span class="s2">&quot;1px solid&quot;</span><span class="p">)]},</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;th&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border&quot;</span><span class="p">,</span> <span class="s2">&quot;1px solid&quot;</span><span class="p">)]},</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;th&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;text-align&quot;</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">)]},</span>
        <span class="p">])</span>
    <span class="n">df1</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Metrics Evaluation [Average Precision - Precision - Recall ]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">object_detector</span><span class="p">))</span>
    <span class="n">df1</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
    <span class="c1">#df1.style.set_table_attributes(&quot;style=&#39;display:inline&#39;&quot;).set_caption(&#39;Caption table&#39;)</span>

    <span class="c1"># df2=df1.style.set_table_styles(</span>
    <span class="c1">#     [{&quot;selector&quot;: &quot;&quot;, &quot;props&quot;: [(&quot;border&quot;, &quot;1px solid&quot;)]},</span>
    <span class="c1">#       {&quot;selector&quot;: &quot;tbody td&quot;, &quot;props&quot;: [(&quot;border&quot;, &quot;1px solid&quot;)]},</span>
    <span class="c1">#      {&quot;selector&quot;: &quot;th&quot;, &quot;props&quot;: [(&quot;border&quot;, &quot;1px solid&quot;)]}])</span>


   
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>


    <span class="c1"># AP - Precision - Recall</span>

    <span class="c1"># metrics_results={</span>
    <span class="c1">#           &#39;Easy Cars&#39;:[cars_easy_AP,car_metrics[0]*100,car_metrics[1]*100],</span>
    <span class="c1">#           &#39;Moderate Cars&#39;:[cars_moderate_AP,car_metrics[2]*100,car_metrics[3]*100],</span>
    <span class="c1">#           &#39;Hard Cars&#39;:[cars_hard_AP,car_metrics[4]*100,car_metrics[5]*100],</span>
    <span class="c1">#           &#39;Overall Cars&#39;:[overall_cars_AP,car_metrics[6]*100,car_metrics[7]*100],</span>
    <span class="c1">#           &#39;Pedestrians Easy&#39;:[pedestrian_easy_AP,pedestrian_metrics[0]*100,pedestrian_metrics[1]*100],</span>
    <span class="c1">#           &#39;Pedestrians Moderate&#39;:[pedestrian_moderate_AP,pedestrian_metrics[2]*100,pedestrian_metrics[3]*100],</span>
    <span class="c1">#           &#39;Pedestrians Hard&#39;:[pedestrian_hard_AP,pedestrian_metrics[4]*100,pedestrian_metrics[5]*100],</span>
    <span class="c1">#           &#39;Overall Pedestrians&#39;:[overall_predestrians_AP,pedestrian_metrics[6]*100,pedestrian_metrics[7]*100],</span>
    <span class="c1">#           &#39;Overall Easy&#39; : [AP_weighted_average_easy,difficulty_metrics[0]*100,difficulty_metrics[1]*100],</span>
    <span class="c1">#           &#39;Overall Moderate&#39; : [AP_weighted_average_moderate,difficulty_metrics[2]*100,difficulty_metrics[3]*100],</span>
    <span class="c1">#           &#39;Overall Hard&#39; : [AP_weighted_average_hard,difficulty_metrics[4]*100,difficulty_metrics[5]*100],</span>
    <span class="c1">#           &#39;Overall Overall&#39; : [overall_AP,overall_precision*100,overall_recall*100]</span>

    <span class="c1">#         }</span>

    <span class="c1"># Easy - Moderate - Hard - Overall</span>
    <span class="n">metrics_results</span><span class="o">=</span><span class="p">{</span>

              <span class="s1">&#39;Cars AP&#39;</span><span class="p">:[</span><span class="n">cars_easy_AP</span><span class="p">,</span><span class="n">cars_moderate_AP</span><span class="p">,</span><span class="n">cars_hard_AP</span><span class="p">,</span><span class="n">overall_cars_AP</span><span class="p">],</span>
              <span class="s1">&#39;Pedestrians AP&#39;</span><span class="p">:[</span><span class="n">pedestrian_easy_AP</span><span class="p">,</span><span class="n">pedestrian_moderate_AP</span><span class="p">,</span><span class="n">pedestrian_hard_AP</span><span class="p">,</span><span class="n">overall_cars_AP</span><span class="p">],</span>
              <span class="s1">&#39;All Classes AP&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">AP_weighted_average_easy</span><span class="p">,</span><span class="n">AP_weighted_average_moderate</span><span class="p">,</span><span class="n">AP_weighted_average_hard</span><span class="p">,</span><span class="n">overall_AP</span><span class="p">],</span>


              <span class="s1">&#39;Cars Precision&#39;</span><span class="p">:[</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Pedestrians Precision&#39;</span><span class="p">:[</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;All Classes Precision&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">overall_precision</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>

              <span class="s1">&#39;Cars Recall&#39;</span><span class="p">:[</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">car_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;Pedestrians Recall&#39;</span><span class="p">:[</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">pedestrian_metrics</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>
              <span class="s1">&#39;All Classes Recall&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">difficulty_metrics</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">overall_recall</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span>

            <span class="p">}</span>

    <span class="n">bar_metrics</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics_results</span><span class="p">)</span>

    <span class="c1"># bar_metrics.plot(kind=&#39;bar&#39;,title=&quot;SMOKE Evaluation Results&quot;)</span>

    <span class="c1"># plt.xlabel(&quot;Difficulties&quot;)</span>
    <span class="c1"># plt.ylabel(&quot;Percentage %&quot;)</span>
    <span class="c1"># plt.xticks(ticks=[0,1,2],labels=[&#39;AP&#39;,&#39;Precision&#39;,&#39;Recall&#39;])</span>



    <span class="k">return</span> <span class="n">df1</span><span class="p">,</span><span class="n">bar_metrics</span></div>

<div class="viewcode-block" id="get_kitti_AP_evaluation"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_kitti_AP_evaluation">[docs]</a><span class="k">def</span> <span class="nf">get_kitti_AP_evaluation</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="n">evaluation_executable_path</span><span class="p">,</span><span class="n">metrics_evaluator</span><span class="p">):</span>
    <span class="c1">#evaluation_executable_path=&#39;.\SMOKE\smoke\data\datasets\evaluation\kitti\kitti_eval_40\eval8.exe&#39;</span>
    <span class="n">boxs_groundtruth_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span><span class="s1">&#39;SMOKE/datasets/kitti/training/label_2&#39;</span><span class="p">)</span>
    <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">evaluation_executable_path</span><span class="p">,</span><span class="n">boxs_groundtruth_path</span><span class="p">,</span> <span class="n">results_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">))</span><span class="c1">#&quot;C:\\Users\\hashot51\\Desktop\\perception-validation-verification\\results\\Streamtest_AP_eval2022_12_23_15_05_34&quot;</span>

    <span class="c1"># Run evaluation command from terminal</span>
    <span class="n">average_precision_command</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">average_precision_command</span><span class="p">)</span></div>

    <span class="c1"># # Get AP from generated files (by previous command)</span>
    <span class="c1"># cars_easy_AP,cars_moderate_AP,cars_hard_AP=get_class_AP(results_path,&#39;Car&#39;)</span>
    <span class="c1"># pedestrian_easy_AP,pedestrian_moderate_AP,pedestrian_hard_AP=get_class_AP(results_path,&#39;Pedestrian&#39;)</span>


    <span class="c1"># cars_AP=[cars_easy_AP,cars_moderate_AP,cars_hard_AP]</span>
    <span class="c1"># pedestrians_AP=[pedestrian_easy_AP,pedestrian_moderate_AP,pedestrian_hard_AP]</span>

    <span class="c1"># # Organize results in clear format + Get weighted average for categories with unavailable info</span>
    <span class="c1"># df,bar_metrics=construct_dataframe_v2(cars_AP,pedestrians_AP,metrics_evaluator.car_metrics,metrics_evaluator.pedestrian_metrics,metrics_evaluator.difficulty_metrics,metrics_evaluator.n_object_classes,metrics_evaluator.n_object_difficulties)</span>



<div class="viewcode-block" id="plot_SMOKE_vs_YOLO"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.plot_SMOKE_vs_YOLO">[docs]</a><span class="k">def</span> <span class="nf">plot_SMOKE_vs_YOLO</span><span class="p">(</span><span class="n">smoke_df</span><span class="p">,</span><span class="n">yolo_df</span><span class="p">,</span><span class="n">results_path</span><span class="p">):</span>
    
    <span class="n">smoke_metrics_dict</span><span class="o">=</span><span class="n">smoke_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="c1">#print(&quot;SMOKE metrics dictionary: &quot;,smoke_metrics_dict)</span>
    <span class="n">smoke_metrics_values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">smoke_metrics_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="c1">#print(&quot;SMOKE metrics values as list: &quot;,smoke_metrics_values)</span>

    <span class="n">smoke_difficulty_columns</span><span class="o">=</span><span class="p">[</span><span class="n">smoke_metrics_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>

    <span class="c1">#print(&quot;SMOKE difficulty columns: &quot;,smoke_difficulty_columns)</span>

    <span class="n">smoke_cars_AP</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">smoke_pedestrians_AP</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">smoke_cars_and_predestrians_AP</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">difficulty_column</span> <span class="ow">in</span> <span class="n">smoke_difficulty_columns</span><span class="p">:</span>
        <span class="n">smoke_cars_AP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">difficulty_column</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">smoke_pedestrians_AP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">difficulty_column</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">smoke_cars_and_predestrians_AP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">difficulty_column</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMOKE cars AP: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">smoke_cars_AP</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMOKE pedestrians AP: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">smoke_pedestrians_AP</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMOKE cars+pedestrians AP: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">smoke_cars_and_predestrians_AP</span><span class="p">)</span>

    <span class="n">yolo_metrics_dict</span><span class="o">=</span><span class="n">yolo_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="c1">#print(&quot;SMOKE metrics dictionary: &quot;,yolo_metrics_dict)</span>
    <span class="n">yolo_metrics_values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">yolo_metrics_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="c1">#print(&quot;SMOKE metrics values as list: &quot;,yolo_metrics_values)</span>

    <span class="n">yolo_difficulty_columns</span><span class="o">=</span><span class="p">[</span><span class="n">yolo_metrics_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>

    <span class="c1">#print(&quot;SMOKE difficulty columns: &quot;,yolo_difficulty_columns)</span>

    <span class="n">yolo_cars_AP</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">yolo_pedestrians_AP</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">yolo_cars_and_predestrians_AP</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">difficulty_column</span> <span class="ow">in</span> <span class="n">yolo_difficulty_columns</span><span class="p">:</span>
        <span class="n">yolo_cars_AP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">difficulty_column</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">yolo_pedestrians_AP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">difficulty_column</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">yolo_cars_and_predestrians_AP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">difficulty_column</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMOKE cars AP: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">yolo_cars_AP</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMOKE pedestrians AP: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">yolo_pedestrians_AP</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMOKE cars+pedestrians AP: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">yolo_cars_and_predestrians_AP</span><span class="p">)</span>

    <span class="n">smoke_vs_yolo_AP</span><span class="o">=</span><span class="p">{</span>

            <span class="s1">&#39;SMOKE cars AP&#39;</span><span class="p">:</span><span class="n">smoke_cars_AP</span><span class="p">,</span>
            <span class="s1">&#39;YOLOv3 cars AP&#39;</span><span class="p">:</span><span class="n">yolo_cars_AP</span><span class="p">,</span>
            <span class="s1">&#39;SMOKE pedestrians AP&#39;</span><span class="p">:</span><span class="n">smoke_pedestrians_AP</span><span class="p">,</span>
            <span class="s1">&#39;YOLOv3 pedestrians AP&#39;</span><span class="p">:</span><span class="n">yolo_pedestrians_AP</span><span class="p">,</span>
            <span class="s1">&#39;SMOKE cars &amp; pedestrians AP&#39;</span><span class="p">:</span><span class="n">smoke_cars_and_predestrians_AP</span><span class="p">,</span>
            <span class="s1">&#39;YOLOv3 cars &amp; pedestrians AP&#39;</span><span class="p">:</span><span class="n">yolo_cars_and_predestrians_AP</span><span class="p">,</span>
            
            
        <span class="p">}</span>

    <span class="n">comparison_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">smoke_vs_yolo_AP</span><span class="p">)</span>

    <span class="n">comparison_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;SMOKE vs YOLOv3 AP&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.16</span><span class="p">,</span><span class="mf">0.7</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Difficulties&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Average Precision %&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Easy&#39;</span><span class="p">,</span><span class="s1">&#39;Moderate&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">,</span><span class="s2">&quot;Overall&quot;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span><span class="s2">&quot;SMOKE_vs_YOLO_AP.png&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="get_dataset_depth_stats"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.get_dataset_depth_stats">[docs]</a><span class="k">def</span> <span class="nf">get_dataset_depth_stats</span><span class="p">(</span><span class="n">labels_path</span><span class="p">,</span><span class="n">depth_condition</span><span class="p">,</span><span class="n">extension</span><span class="p">,</span><span class="n">frame_id</span><span class="o">=</span><span class="s2">&quot;All&quot;</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">frame_id</span><span class="o">==</span><span class="s2">&quot;All&quot;</span><span class="p">:</span>
        <span class="n">n_labels</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">labels_path</span><span class="p">))</span>
        <span class="n">file_ids</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_labels</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">file_ids</span><span class="o">=</span><span class="p">[</span><span class="n">frame_id</span><span class="p">]</span>


    <span class="c1">#n_labels=n_frames</span>

    <span class="n">groundtruth</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">file_ids</span><span class="p">:</span>
        <span class="n">groundtruth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_read_groundtruth</span><span class="p">(</span><span class="n">labels_path</span><span class="p">,</span><span class="n">fileid</span><span class="p">,</span><span class="n">extension</span><span class="o">=</span><span class="n">extension</span><span class="p">,</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;Prescan&quot;</span><span class="p">))</span>

    
    <span class="n">objects_depth</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">cars_l</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">cars_w</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">cars_h</span><span class="o">=</span><span class="p">[]</span>

    

    <span class="k">for</span> <span class="n">gt_list</span> <span class="ow">in</span> <span class="n">groundtruth</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">gt_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gt</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Person&quot;</span><span class="p">,</span><span class="s2">&quot;Car&quot;</span><span class="p">,</span><span class="s2">&quot;Cyclist&quot;</span><span class="p">]:</span>
                <span class="n">depth</span><span class="o">=</span><span class="n">gt</span><span class="o">.</span><span class="n">tz</span>
                <span class="k">if</span> <span class="n">depth_condition</span><span class="o">&gt;=</span><span class="n">depth</span><span class="p">:</span>

                    <span class="n">objects_depth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">depth</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">gt</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="s2">&quot;Car&quot;</span><span class="p">:</span>
                        <span class="n">cars_l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
                        <span class="n">cars_w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>
                        <span class="n">cars_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>

    <span class="n">depth_mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">objects_depth</span><span class="p">)</span>
    <span class="n">depth_std</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">objects_depth</span><span class="p">)</span>

    <span class="n">car_dim_reference</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cars_l</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cars_h</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cars_w</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">depth_mean</span><span class="p">,</span><span class="n">depth_std</span><span class="p">,</span><span class="n">car_dim_reference</span></div>

<div class="viewcode-block" id="video_writer"><a class="viewcode-back" href="../index.html#metrics_functions_from_evaluation_script.video_writer">[docs]</a><span class="k">def</span> <span class="nf">video_writer</span><span class="p">(</span><span class="n">images_folder_path</span><span class="p">,</span><span class="n">video_filename</span><span class="p">,</span><span class="n">fps</span><span class="p">,</span><span class="n">results_path</span><span class="p">):</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;video_writer&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Images Folder Path: &quot;</span><span class="p">,</span><span class="n">images_folder_path</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="p">[</span><span class="n">images_folder_path</span><span class="p">]:</span>

        <span class="n">images_dir_list</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span> <span class="c1"># your directory path</span>
        <span class="n">number_images</span> <span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">images_dir_list</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Images: &quot;</span><span class="p">,</span><span class="n">number_images</span><span class="p">)</span>

        <span class="c1"># choose codec according to format needed</span>
        <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;mp4v&#39;</span><span class="p">)</span> 
        <span class="n">codec</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;XVID&#39;</span><span class="p">)</span>
        <span class="c1"># Read Image Just To get shape</span>
        <span class="n">image_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image Path: &quot;</span><span class="p">,</span><span class="n">image_path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image Path replaced backslash: &quot;</span><span class="p">,</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">img</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>

        <span class="c1"># if folder==smoke_image_results_folder:</span>
        <span class="c1">#     video_filename=&quot;SMOKE_detections.mp4&quot;</span>
        <span class="c1"># elif folder==smoke_birdview_results_folder:</span>
        <span class="c1">#     video_filename=&quot;SMOKE_birdview.mp4&quot;</span>
        <span class="c1"># else:</span>
        <span class="c1">#     video_filename=&quot;SMOKE_overview.mp4&quot;</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_path</span><span class="p">,</span><span class="n">video_filename</span><span class="p">),</span> <span class="n">codec</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>


        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_images</span><span class="p">):</span>
            <span class="n">image_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IMAGE PATH: &#39;</span><span class="p">,</span><span class="n">image_path</span><span class="p">)</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="c1"># cv2.imshow(&#39;output&#39;,img)</span>
            <span class="c1"># cv2.waitKey(0)</span>
            <span class="n">video</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
            <span class="c1">#frame_id+=1</span>

        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
        <span class="n">video</span><span class="o">.</span><span class="n">release</span><span class="p">()</span></div>

    







</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hassan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>